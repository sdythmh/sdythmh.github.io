<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false,"labels":{"input_placeholder":"Search for Posts","hits_empty":"抱歉哦，没有找到你要查找的内容: ${query}"}},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="本文将从h08开始，介绍每一次作业的做法，其中h05是java程序设计lab1，h11是java程序设计lab2，这里就不做过多赘述了">
<meta property="og:type" content="article">
<meta property="og:title" content="java作业">
<meta property="og:url" content="http://example.com/2024/04/19/java%E4%BD%9C%E4%B8%9A/index.html">
<meta property="og:site_name" content="Charoneo&#39;s Blog">
<meta property="og:description" content="本文将从h08开始，介绍每一次作业的做法，其中h05是java程序设计lab1，h11是java程序设计lab2，这里就不做过多赘述了">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2024/04/19/java%E4%BD%9C%E4%B8%9A/image-20240427183859315.png">
<meta property="article:published_time" content="2024-04-18T16:18:00.000Z">
<meta property="article:modified_time" content="2024-05-31T11:07:04.000Z">
<meta property="article:author" content="Charoneo">
<meta property="article:tag" content="java实验">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2024/04/19/java%E4%BD%9C%E4%B8%9A/image-20240427183859315.png">

<link rel="canonical" href="http://example.com/2024/04/19/java%E4%BD%9C%E4%B8%9A/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>java作业 | Charoneo's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
	<a target="_blank" rel="noopener" href="https://your-url" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Charoneo's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="fa fa-download fa-fw"></i>资源</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/04/19/java%E4%BD%9C%E4%B8%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.webp">
      <meta itemprop="name" content="Charoneo">
      <meta itemprop="description" content="个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charoneo's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          java作业
        </h1>

        <div class="post-meta">
	
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-04-19 00:18:00" itemprop="dateCreated datePublished" datetime="2024-04-19T00:18:00+08:00">2024-04-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-05-31 19:07:04" itemprop="dateModified" datetime="2024-05-31T19:07:04+08:00">2024-05-31</time>
              </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/2024/04/19/java%E4%BD%9C%E4%B8%9A/#SOHUCS" itemprop="discussionUrl">
        <span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="2024/04/19/java作业/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>68k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1:02</span>
            </span>
            <div class="post-description">本文将从h08开始，介绍每一次作业的做法，其中h05是java程序设计lab1，h11是java程序设计lab2，这里就不做过多赘述了</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="h03"><a href="#h03" class="headerlink" title="h03"></a>h03</h1><p>这里写一个也是唯一一个难度系数3星的任务</p>
<p>返回杨辉三角( Pascal  triangle,请百度 杨辉三角 或者 Pascal  triangle )第i行的系数，杨辉三角第一行定义为1<br>提示：从顶部的单个1开始，下面一行中的每个数字都是上面两个数字的和<br>例如getPascalTriangle(1)返回{1}，<br>getPascalTriangle(2)返回{1,1}<br>测试的时候，系数肯定不会超过int的范围 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] getPascalTriangle(<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="type">int</span>[] row = <span class="keyword">new</span> <span class="title class_">int</span>[i];</span><br><span class="line">    Arrays.fill(row, <span class="number">1</span>);		<span class="comment">//全部填充为1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> <span class="number">2</span>;r &lt;=i;r++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> r-<span class="number">2</span>;j &gt;=<span class="number">1</span>;j--) &#123;</span><br><span class="line">            row[j] = row[j] + row[j-<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> row;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>每次都是先复制一下上一行的数据，然后从最后一行的倒数第二个数开始向前累加，从而实现当前值等于正上方值+左上方值</p>
<h1 id="h08"><a href="#h08" class="headerlink" title="h08"></a>h08</h1><p><font color = "blue">注意本次实验部分任务相似，所以只给出一部分任务的做法</font></p>
<p><strong>任务1</strong>：LoginUtil是一个登录的类，分别输入用户口令，当用户名为”a”,口令为”a”,不抛出异常，否则抛出InvalidUserExcetpion(InvalidUserExcetpion需要你自己定义)</p>
<p><strong>做法</strong>：</p>
<ol>
<li>设计LoginUtil类</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginUtil</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">login</span><span class="params">(String a, String b)</span>  <span class="keyword">throws</span> InvalidUserException&#123;</span><br><span class="line">		<span class="keyword">if</span>(a.equals(<span class="string">&quot;a&quot;</span>) &amp;&amp; b.equals(<span class="string">&quot;a&quot;</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InvalidUserException</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>定义InvalidUserException</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InvalidUserException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">InvalidUserException</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">InvalidUserException</span><span class="params">(String message, Throwable cause)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(message,cause);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">InvalidUserException</span><span class="params">(String message)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(message);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">InvalidUserException</span><span class="params">(Throwable cause)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(cause);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里要注意一般自定义的异常都是集成RuntimeException，在构造的异常里面可以定义四个构造方法（模版），但不是必须</p>
<p><strong>任务2</strong>：</p>
<p>构造一个 AgeCheck类，实现AgeCheckInterface接口， 当checkAge中的参数&lt;0或者&gt;200的时候抛出异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span>  <span class="title class_">AgeCheckInterface</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkAge</span><span class="params">(<span class="type">int</span> age)</span>  ;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>做法</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AgeCheck</span> <span class="keyword">implements</span> <span class="title class_">AgeCheckInterface</span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkAge</span><span class="params">(<span class="type">int</span> age)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(age &lt;<span class="number">0</span> || age &gt;<span class="number">200</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();			<span class="comment">//注意这里不能抛出Exception</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h09"><a href="#h09" class="headerlink" title="h09"></a>h09</h1><p><strong>任务1</strong>：</p>
<p>计算出一段文字中不重复的字符的个数，例如“天津市天津大学 ”不重复字符为5</p>
<p><strong>做法</strong>：</p>
<p>利用set的特性，里面的元素不能重复</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDistinctCharCount</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    Set&lt;String&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    <span class="type">char</span>[] charArray = s.toCharArray();</span><br><span class="line">    String[] stringArray = <span class="keyword">new</span> <span class="title class_">String</span>[charArray.length];		<span class="comment">//构造一个字符串数组</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;charArray.length;i++) &#123;</span><br><span class="line">        stringArray[i] = String.valueOf(charArray[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s.length();i++) &#123;</span><br><span class="line">        set.add(stringArray[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> set.size();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意本方法先把字符串转换为char类型的数组，构造了一个字符串数组，把char类型的数组每个部分的内容填到字符串数组的对应位置上，注意<code>String.valueOf</code>方法的使用</p>
<p><a id = "task2"><strong>任务2</strong>：</a></p>
<p>返回一段文字中，出现频率最高的字符（不考虑并列第一的情况） 例如：getFrequentChar(“好好学习”) 返回’好’</p>
<p>例如：getFrequentChar(“我是天津大学软件学院学生”) 返回’学’</p>
<p><strong>做法</strong>：</p>
<p>利用Map的特性，K-V键值对</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">char</span> <span class="title function_">getFrequentChar</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    Map&lt;Character, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s.length();i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(map.containsKey(s.charAt(i))) &#123;</span><br><span class="line">            map.put(s.charAt(i), map.get(s.charAt(i))+<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            map.put(s.charAt(i), <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">char</span> <span class="variable">res</span> <span class="operator">=</span> <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(Map.Entry&lt;Character, Integer&gt; entry: map.entrySet()) &#123;			<span class="comment">//使用entrySet遍历</span></span><br><span class="line">        <span class="keyword">if</span>(maxCount &lt; entry.getValue()) &#123;</span><br><span class="line">            res = entry.getKey();</span><br><span class="line">            maxCount = entry.getValue();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意其中的<code>if...else</code>部分还可以用以下代码来代替。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map.put(s.CharAt(i),map.getOrDefault(s.charAt(i),<span class="number">0</span>)+<span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<p>注意<code>charAt</code>函数的使用：返回指定索引的字符</p>
<p>注意<code>entrySet</code>的遍历：Map.Entry&lt;Character, Integer&gt; entry: map.entrySet()</p>
<p><strong>任务3</strong>：</p>
<p>返回一段文字中，出现频率最高的词（每个词由2个字符构成，任意两个相邻的字符称为一个词，例如“天津大学，你好”由“天津”“津大”“大学”“学，”“，你”“你好” 6个词构成)，不会出现频率最高并列的情况</p>
<p><strong>做法</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">getFrequentWord</span><span class="params">(String content)</span>&#123;</span><br><span class="line">    Map&lt;String, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;content.length()-<span class="number">1</span>;i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(map.containsKey(content.substring(i, i+<span class="number">2</span>))) &#123;			<span class="comment">//注意substring的字符之间是索引</span></span><br><span class="line">            map.put(content.substring(i, i+<span class="number">2</span>), map.get(content.substring(i, i+<span class="number">2</span>))+<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            map.put(content.substring(i, i+<span class="number">2</span>), <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">res</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(Map.Entry&lt;String, Integer&gt; entry: map.entrySet()) &#123;</span><br><span class="line">        <span class="keyword">if</span>(maxCount &lt; entry.getValue()) &#123;</span><br><span class="line">            res = entry.getKey();</span><br><span class="line">            maxCount = entry.getValue();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个方法和<a href="#task2">任务2</a>是比较类似的，区别是多了一个<code>substring</code>函数</p>
<p><strong>任务4</strong>：</p>
<p>把一个StringBufer中所有的空格去掉，提示：不能新建StringBuffer对象，必须在原来的基础上删掉原来字符串</p>
<p><strong>做法</strong>：</p>
<p>通过从头到尾循环，如果对应的字符为空格，就删除。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">zipStringBufer</span><span class="params">(StringBuffer buf)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;buf.length();i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(buf.charAt(i) == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">            buf.deleteCharAt(i--);			<span class="comment">//删了以后i也要减1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意<code>deleteCharAt</code>函数的使用，<font color = "red">注意删除后索引i也要-1，否则遇到连续空格的情况下会有逻辑错误</font></p>
<h1 id="h10"><a href="#h10" class="headerlink" title="h10"></a>h10</h1><p><strong>任务1</strong>：</p>
<p>将一个字符串中字符按出现频率的高到低排序返回，如果两个字符出现的频率一样，则将最先出现的字符排在前面，例如：</p>
<ul>
<li><p>orderChar(“abcdefg”)返回 “abcdefg” </p>
</li>
<li><p>orderChar(“abcdefgg”)返回 “gabcdef”</p>
</li>
<li><p>orderChar(“abcdefgge”)返回 “egabcdf”</p>
</li>
<li><p>orderChar(“天津大学软件学院”)返回 “学天津大软件院”</p>
</li>
</ul>
<p><strong>做法</strong>：</p>
<p>注意这里要使用TreeMap，在Map内部对元素进行排序<font color = "red">注意TreeMap的构造方法</font></p>
<p>注意<code>indexOf</code>函数的使用方法</p>
<p>Comparator在返回时，如果a&lt;b，返回-1，把小的排在前面；如果a&gt;b，返回-1，则把大的排在前面</p>
<p>最后则是先选出其中出现次数最多字符的次数，然后从这个次数开始，每次循环遍历Map，按照出现频率递减的方式来拼接字符串</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Home10</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Home10</span><span class="params">()</span> &#123;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 将一个字符串中字符按出现频率的高到低排序返回，如果两个字符出现的频率一样，则将最先出现的字符排在前面</span></span><br><span class="line"><span class="comment">	 * 例如：orderChar(“abcdefg”)返回 “abcdefg” </span></span><br><span class="line"><span class="comment">	 * orderChar(“abcdefgg”)返回 “gabcdef”</span></span><br><span class="line"><span class="comment">	 * orderChar(“abcdefgge”)返回 “egabcdf”</span></span><br><span class="line"><span class="comment">	 * orderChar(“天津大学软件学院”)返回 “学天津大软件院”</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> content</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">orderChar</span><span class="params">(String content)</span> &#123;</span><br><span class="line">		Map&lt;Character, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Character&gt;() &#123;</span><br><span class="line">			<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Character c1, Character c2)</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>(c1.equals(c2)) &#123;			<span class="comment">//不要忘记相等的情况，否则会出现g=1,g=1的情况；这里还必须用equals，否则用=会出现中文不支持</span></span><br><span class="line">					<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> content.indexOf(c1) &lt; content.indexOf(c2) ? -<span class="number">1</span> :<span class="number">1</span>;			<span class="comment">//索引值小的放在前面</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt;content.length();i++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(map.containsKey(content.charAt(i))) &#123;</span><br><span class="line">				map.put(content.charAt(i), map.get(content.charAt(i))+<span class="number">1</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">				map.put(content.charAt(i), <span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="type">String</span> <span class="variable">res</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">		<span class="type">int</span> <span class="variable">maxCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(Map.Entry&lt;Character, Integer&gt; entry: map.entrySet()) &#123;</span><br><span class="line">			<span class="keyword">if</span>(maxCount &lt; entry.getValue()) &#123;				<span class="comment">//先求出出现最多的次数</span></span><br><span class="line">				maxCount = entry.getValue();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> maxCount; i&gt;<span class="number">0</span>;i--) &#123;			<span class="comment">//这层循环在外面qaq</span></span><br><span class="line">			<span class="keyword">for</span>(Map.Entry&lt;Character, Integer&gt; entry: map.entrySet()) &#123;</span><br><span class="line">				<span class="keyword">if</span>(entry.getValue()==i) &#123;</span><br><span class="line">					res += entry.getKey();			<span class="comment">//拼接字符串直接用+即可</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h11"><a href="#h11" class="headerlink" title="h11"></a>h11</h1><p><a href = "https://sdythmh.github.io/2024/04/16/java程序设计-lab2" target = "_blank">见java程序设计lab2</a></p>
<h1 id="h12"><a href="#h12" class="headerlink" title="h12"></a>h12</h1><p><strong>任务1</strong>：</p>
<p>字符串content是一个超市的历次购物小票的合计，每次购物的明细之间用分号分割，每个商品之间用半角逗号分开</p>
<p>请找出   哪n(n&gt;&#x3D;1)个商品被同时购买的频率最高，将这n个商品名称的集合（set)返回。</p>
<p>历次购物的明细，例如：炸鸡,可乐,啤酒;薯片,啤酒,炸鸡;啤酒,雪碧,炸鸡。哪n个商品被同时购买的频率最高，将这n个商品名称的集合（set)返回 </p>
<p><strong>做法</strong>：</p>
<p>首先整体来讲是先将历次购物明细按照“；”分割成每次的明细，再将每次的明细按照“，”分解成不同的商品存到uniqueProducts中，利用一个<code>generateCombinations</code>函数来根据Set产生组合，把所有的组合都存到结果Map中。</p>
<p>看上去比较复杂的原因之一是Map的key值是Set&lt;String&gt;类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">getFrequentItem</span><span class="params">(String content,<span class="type">int</span> n)</span>  &#123;</span><br><span class="line">    String[] sessions = content.split(<span class="string">&quot;;&quot;</span>);</span><br><span class="line">    Map&lt;Set&lt;String&gt;, Integer&gt; allPairMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(String session : sessions) &#123;</span><br><span class="line">        String[] products = session.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        Set&lt;String&gt; uniqueProducts = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(String product: products) &#123;</span><br><span class="line">            uniqueProducts.add(product.trim());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(uniqueProducts.size() &gt;= n) &#123;</span><br><span class="line">            Set&lt;Set&lt;String&gt;&gt; combinations = generateCombinations(uniqueProducts, n);</span><br><span class="line">            <span class="keyword">for</span>(Set&lt;String&gt; combination : combinations) &#123;</span><br><span class="line">                allPairMap.put(combination,allPairMap.getOrDefault(combination, <span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Set&lt;String&gt; maxFrequent = <span class="literal">null</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxFrequentCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(Map.Entry&lt;Set&lt;String&gt;, Integer&gt; entry : allPairMap.entrySet()) &#123;</span><br><span class="line">        <span class="keyword">if</span>(maxFrequentCount &lt; entry.getValue()) &#123;</span><br><span class="line">            maxFrequentCount = entry.getValue();</span><br><span class="line">            maxFrequent = entry.getKey();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>  maxFrequent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下类是<code>generateCombinations</code>函数的实现，将products集合转换为ArrayList（这里注意转换的方法），传入n个商品的n值，开始索引start，当前Set集合（回溯法用到），和结果集合。</p>
<p><code>generateCombinationsHelper</code>函数主要用到了回溯法，如果当前集合的大小为n，则把当前集合加入到结果集中，否则从第start项开始，分别把不用的product加进去，add完后还要remove，这样就可以添加别的元素，这也是回溯法的本质。</p>
<p>可以类比理解为dfs</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Set&lt;Set&lt;String&gt;&gt; <span class="title function_">generateCombinations</span><span class="params">(Set&lt;String&gt; products, <span class="type">int</span> n)</span>&#123;</span><br><span class="line">    Set&lt;Set&lt;String&gt;&gt; result = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    generateCombinationsHelper(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(products), n , <span class="number">0</span>, <span class="keyword">new</span> <span class="title class_">LinkedHashSet</span>&lt;&gt;(), result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">generateCombinationsHelper</span><span class="params">(List&lt;String&gt; products, <span class="type">int</span> n, <span class="type">int</span> start, Set&lt;String&gt; current, Set&lt;Set&lt;String&gt;&gt; result)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(current.size() == n) &#123;</span><br><span class="line">        result.add(<span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(current));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> start; i&lt; products.size();i++) &#123;</span><br><span class="line">        current.add(products.get(i));</span><br><span class="line">        generateCombinationsHelper(products, n,i+<span class="number">1</span>,current,result);</span><br><span class="line">        current.remove(products.get(i));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h13"><a href="#h13" class="headerlink" title="h13"></a>h13</h1><p><strong>任务1</strong>：</p>
<p>返回红楼梦中出现频率最高的N个词，频率从高到低排列（所谓词就是两个相邻的汉字）</p>
<p><strong>做法</strong>：</p>
<p>首先还是通过Map进行每个词语出现次数的统计，注意这里使用了<code>matches</code>函数，汉字的编码范围是<code>[\\u4e00-\\u9fa5]</code></p>
<p>接下来构造一个List，其中的元素是Map.Entry这个对象，构造函数的参数为entrySet。</p>
<p>下面利用List中的sort方法，里面的参数是lamda函数，a和b分别代表List中的两个元素，把这两个元素的频率取出来做比较，把大的放在前面，最后我们就得到了频率从高到低的排序。</p>
<p>根据这个排序结果，从FrequentList取出前n个元素（Map.Entry对象），然后通过<code>getKey()</code>来得到相应的字符串，放到result中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getTopNWords</span><span class="params">(  <span class="type">int</span> n)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> readFromTxt(<span class="built_in">this</span>.filename);</span><br><span class="line">    Map&lt;String, Integer&gt; FrequencyWord = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;text.length()-<span class="number">1</span>;i++) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">word</span> <span class="operator">=</span> text.substring(i,i+<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span>(word.matches(<span class="string">&quot;[\\u4e00-\\u9fa5]&#123;2&#125;&quot;</span>)) &#123;		<span class="comment">//确保是两个汉字</span></span><br><span class="line">            FrequencyWord.put(word, FrequencyWord.getOrDefault(word, <span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;Map.Entry&lt;String, Integer&gt;&gt; FrequentList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(FrequencyWord.entrySet());</span><br><span class="line">    FrequentList.sort((a,b)-&gt;b.getValue().compareTo(a.getValue()));</span><br><span class="line"></span><br><span class="line">    List&lt;String&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n &amp;&amp; i &lt;FrequentList.size();i++) &#123;</span><br><span class="line">        result.add(FrequentList.get(i).getKey());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>任务2</strong>：</p>
<p>将红楼梦文本文件拆分为120个章节，返回120个元素的字符串数组</p>
<p><strong>做法</strong>：</p>
<p>注意这里要修改已经给出的代码，因为是用<code>split</code>根据特定的正则表达式分割的，第一回前面还有部分与内容无关的部分，因此要通过<code>Arrays.copyOfRange</code>函数返回原来字符串数组除去第一部分的内容。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String[] splitContentToChapter(String content) &#123;</span><br><span class="line">    <span class="comment">// 提示 使用 content.split(&quot; 第[一,二,三,四,五,六,七,八,九,十,零]&#123;1,5&#125;回 &quot;);正则表达拆分</span></span><br><span class="line">    <span class="comment">// 百度一下正则表达式</span></span><br><span class="line">    String contents[] = content.split(<span class="string">&quot; 第[一,二,三,四,五,六,七,八,九,十,零]&#123;1,5&#125;回 &quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> Arrays.copyOfRange(contents, <span class="number">1</span>, contents.length);		<span class="comment">//去除第一章节之前的非正式内容</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>任务3</strong>：</p>
<p>统计红楼梦章节字符串str出现的频率，把每一章出现的频率存到result[章节数]并返回这个数组</p>
<p><strong>做法</strong>：</p>
<p>首先调用<code>readFromTxt</code>和<code>splitContentToChapter</code>这两个上面已经定义好的方法，得到的结果存到chapters数组中，然后遍历数组。</p>
<p>多说一嘴<code>readFromTxt</code>函数，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String <span class="title function_">readFromTxt</span><span class="params">(String filename)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Reader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">buf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="type">char</span>[] chars = <span class="keyword">new</span> <span class="title class_">char</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="comment">// InputStream in=new FileInputStream(filename);</span></span><br><span class="line"></span><br><span class="line">        reader = <span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filename), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">readed</span> <span class="operator">=</span> reader.read(chars);</span><br><span class="line">        <span class="keyword">while</span> (readed != -<span class="number">1</span>) &#123;</span><br><span class="line">            buf.append(chars, <span class="number">0</span>, readed);</span><br><span class="line">            readed = reader.read(chars);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> buf.toString();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        close(reader);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里的FileInputStream是字节流，是超类InputStream的具体实现。InputStreamReader是把字节流转换为字符流，然后用Reader来接收。这里也可以用BufferedReader，BufferedReader的好处是可以通过<code>readLine</code>来逐行读取</p>
<p>这里要注意<code>indexOf(String, int)</code>的使用，返回str从index位置开始出现的位置，如果未找到则返回-1.</p>
<p>注意每次找到str后要把当前的str跳过去，也就是把index加上str的长度</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] getStringFrequent(String str) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">int</span>[] result = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">120</span>];</span><br><span class="line">    <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> readFromTxt(<span class="built_in">this</span>.filename);</span><br><span class="line">    <span class="built_in">this</span>.chapters = splitContentToChapter(text);</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(String chapter : chapters) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(index != -<span class="number">1</span>) &#123;</span><br><span class="line">            index = chapter.indexOf(str, index);			<span class="comment">//从index开始查找str，返回查找到的索引</span></span><br><span class="line">            <span class="keyword">if</span>(index != -<span class="number">1</span>) &#123;</span><br><span class="line">                count++;</span><br><span class="line">                index += str.length();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        result[i++] = count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h14"><a href="#h14" class="headerlink" title="h14"></a>h14</h1><p><strong>任务</strong>1：</p>
<p> 现在所有学生的名单students.txt（为了避免乱码问题，文件中不包含汉字），其中每行为一个学生信息，包括学号、姓名、班级，以tab符号分割(\t)，</p>
<p>学院要求所有同学把自己一寸照片发给辅导员，图片命名规则为 “学号.jpg” </p>
<p>现在存在下列问题。请用编程的方式帮助辅导员解决如下问题：</p>
<ul>
<li><p>找出哪些同学的照片没有交照片； </p>
</li>
<li><p>在目标目录下每个班级建立一个子目录，把上交的同学的照片，统一按 学号_姓名.jpg 方式拷贝到各自班级目录下，原来的文件不要删除.</p>
</li>
</ul>
<p>已知的测试信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实际测试中，文件存放位置可能改变，学生数量也可能改变</span></span><br><span class="line"><span class="comment">// 其中每行为一个学生信息，包括学号、姓名、班级，以tab符号分割(\t)，</span></span><br><span class="line">String studentListFileName=<span class="string">&quot;E:/EclipseWorkspace/hw1/src/com/huawei/classroom/student/h14/students.txt&quot;</span>;</span><br><span class="line"><span class="comment">// 学生照片存放的目录，不会包含子目录，本目录的pic给出了存放图片的目录示例，实际测试中，pic 位置可能改变，其下面文件数量也会改变</span></span><br><span class="line">String picDir=<span class="string">&quot;E:/EclipseWorkspace/hw1/src/com/huawei/classroom/student/h14/pic/&quot;</span>;</span><br><span class="line">String targetDir=<span class="string">&quot;E:/EclipseWorkspace/hw1/src/com/huawei/classroom/student/h14/target/&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>做法</strong>：</p>
<p>首先要注意的就是返回值的类型是Set&lt;String&gt;，所以要首先构造一个noPicIds的集合用来存储没有提交照片的学生的学号。</p>
<p>然后用<code>BufferedReader</code>来读取<code>studentListFile</code>（这是一个String类型的路径）中的内容，利用<code>readLine()</code>函数来读取每一行的内容，然后通过<code>split</code>方法分别取出studentId, studentName, studentClass.</p>
<p>然后根据studentId来打开jpg文件</p>
<ul>
<li>如果存在，则说明提交了文件，然后创建相应的班级文件夹，把图片拷贝到班级文件夹下</li>
</ul>
<p>注意<code>File.copy</code>函数的使用方法：这里的原型是<code>File.copy(Paths, Paths, Options)</code>，表示把第一个Paths对象拷贝到第二个Paths对象。具体来讲，就是<code>getPath()</code>函数得到文件的字符串路径，利用<code>Paths.get</code>函数得到一个静态的Paths对象，其中<code>StandardCopyOption.REPLACE_EXISTING</code>代表拷贝时如果名字相同，则替换已有的文件。</p>
<ul>
<li>如果不存在，则说明没有提交文件。那么就把这个学生的学号放到noPidIds集合中。</li>
</ul>
<p>同时还要注意，在使用BufferdReader时要考虑异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">copyToTargetDirAndReturnNoExist</span><span class="params">(String studentListFile,String srcDir,String target)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    Set&lt;String&gt; noPicIds = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    <span class="type">File</span> <span class="variable">dir</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(target);</span><br><span class="line">    <span class="keyword">if</span>(!dir.exists()) &#123;</span><br><span class="line">        dir.mkdirs();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>(<span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(studentListFile)))&#123;</span><br><span class="line">        String line;</span><br><span class="line">        <span class="keyword">while</span>((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">            String[] details = line.split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">studentId</span> <span class="operator">=</span> details[<span class="number">0</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">StuName</span> <span class="operator">=</span> details[<span class="number">1</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">StuClass</span> <span class="operator">=</span> details[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">            <span class="type">File</span> <span class="variable">picFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(srcDir + studentId + <span class="string">&quot;.jpg&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(picFile.exists()) &#123;</span><br><span class="line">                <span class="type">File</span> <span class="variable">targetFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(target + StuClass);</span><br><span class="line">                <span class="keyword">if</span>(!targetFile.exists()) &#123;</span><br><span class="line">                    targetFile.mkdirs();</span><br><span class="line">                &#125;</span><br><span class="line">                Files.copy(Paths.get(picFile.getPath()), Paths.get(targetFile.getPath(),studentId +<span class="string">&quot;_&quot;</span> + StuName + <span class="string">&quot;.jpg&quot;</span>),StandardCopyOption.REPLACE_EXISTING);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                noPicIds.add(studentId);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(IOException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot;Error Handling File Operations&quot;</span>,e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> noPicIds;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h15"><a href="#h15" class="headerlink" title="h15"></a>h15</h1><p><strong>任务1</strong>：</p>
<p>测试程序输入一个StringBuffer，刚输入的时候StringBuffer值为空，等待1000ms后，这个StringBuffer的值变为”ok”</p>
<p><strong>做法</strong>：</p>
<p>考点主要是重写<code>run</code>方法和<code>Thread.sleep</code>的使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadUtil</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> StringBuffer buf;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">ThreadUtil</span><span class="params">(StringBuffer buf)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.buf = buf;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">			buf.append(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			System.out.println(<span class="string">&quot;Thread was Interrupted!&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>任务2</strong>：</p>
<p>多线程方式，统计[start,end)区间所有的质数，并且小到大排序返回</p>
<p><strong>做法</strong>：</p>
<p>首先利用<code>ExecutorService</code>创建一个指定大小的线程池，大小具体为传进来的参数threadCount。</p>
<p>然后设置一个List里面专门用来存放future对象</p>
<p>接下来计算每个线程处理的区间大小，让每个线程处理的数字数量几乎相等，注意如果是最后一个线程，必须处理到末尾（end）</p>
<p><code>executor</code>在<code>submit</code>时，应该用实现<code>Callable</code>接口而不是<code>Runnable</code>接口，因为<code>Callable</code>接口可以有返回值，在重写的<code>call()</code>方法中完成对素数的挑选。</p>
<p>注意<code>submit</code>返回的对象是<code>Future</code>，所以我们把每一个<code>Future</code>对象都存到一个<code>List</code>中，最后把<code>List</code>中所有的<code>Future</code>对象中的对象（类型是<code>List&lt;long&gt;</code>）合并（用<code>addAll</code>函数）为一个大的<code>List</code>。</p>
<p>最后调用<code>Collections.sort()</code>方法对这个<code>List</code>进行排序，返回结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Future;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Callable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PrimeUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Long&gt; <span class="title function_">getPrimeList</span><span class="params">(<span class="type">long</span> start, <span class="type">long</span> end, <span class="type">int</span> threadCount)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">executor</span> <span class="operator">=</span> Executors.newFixedThreadPool(threadCount);</span><br><span class="line">        List&lt;Future&lt;List&lt;Long&gt;&gt;&gt; futures = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">long</span> <span class="variable">blockSize</span> <span class="operator">=</span> (end - start) / threadCount;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; threadCount; i++) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">localStart</span> <span class="operator">=</span> start + i * blockSize;</span><br><span class="line">            <span class="type">long</span> <span class="variable">localEnd</span> <span class="operator">=</span> (i == threadCount - <span class="number">1</span>) ? end : localStart + blockSize;</span><br><span class="line">            futures.add(executor.submit(<span class="keyword">new</span> <span class="title class_">PrimeTask</span>(localStart, localEnd)));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        List&lt;Long&gt; primes = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Future&lt;List&lt;Long&gt;&gt; future : futures) &#123;</span><br><span class="line">            primes.addAll(future.get()); <span class="comment">// Retrieve and combine results</span></span><br><span class="line">        &#125;</span><br><span class="line">        executor.shutdown();</span><br><span class="line"></span><br><span class="line">        Collections.sort(primes); <span class="comment">// Ensure the primes are sorted</span></span><br><span class="line">        <span class="keyword">return</span> primes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">PrimeTask</span> <span class="keyword">implements</span> <span class="title class_">Callable</span>&lt;List&lt;Long&gt;&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">long</span> start, end;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">PrimeTask</span><span class="params">(<span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.start = start;</span><br><span class="line">            <span class="built_in">this</span>.end = end;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> List&lt;Long&gt; <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            List&lt;Long&gt; localPrimes = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">number</span> <span class="operator">=</span> start; number &lt; end; number++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (isPrime(number)) &#123;</span><br><span class="line">                    localPrimes.add(number);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> localPrimes;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isPrime</span><span class="params">(<span class="type">long</span> number)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (number &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (number &lt;= <span class="number">3</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (number % <span class="number">2</span> == <span class="number">0</span> || number % <span class="number">3</span> == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">5</span>; i * i &lt;= number; i += <span class="number">6</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (number % i == <span class="number">0</span> || number % (i + <span class="number">2</span>) == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h16"><a href="#h16" class="headerlink" title="h16"></a>h16</h1><p><strong>任务</strong>：</p>
<p>首先看一下Test.java中的main方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">    <span class="comment">// 端口号测试的时候随机给</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">8088</span>;</span><br><span class="line">    <span class="comment">// 要求完成MyServer类</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">MyServer</span>().startListen(port);</span><br><span class="line">    <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">BufferedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        socket = <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="string">&quot;127.0.0.1&quot;</span>, port);</span><br><span class="line">        out = <span class="keyword">new</span> <span class="title class_">java</span>.io.PrintWriter(socket.getOutputStream());</span><br><span class="line">        <span class="comment">// 获得输入流</span></span><br><span class="line">        in = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(socket.getInputStream()));</span><br><span class="line">        <span class="comment">// 随机测试向服务器端输入几句话，要求服务器端原封不动返回</span></span><br><span class="line">        <span class="keyword">if</span> (testEcho(in, out, <span class="string">&quot;hellow&quot;</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ok 1&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (testEcho(in, out, <span class="string">&quot;haha&quot;</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ok 2&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 向服务器端输入bye，断开表示断开连接</span></span><br><span class="line">        out.write(<span class="string">&quot;bye&quot;</span> + <span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        out.close();</span><br><span class="line">        in.close();</span><br><span class="line">        socket.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        close(in);</span><br><span class="line">        close(out);</span><br><span class="line">        close(socket);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>做法</strong>：</p>
<p>MyServer类实现监听方法，主要是创建一个新线程，不断的启动线程，采用多线程的方式来实现服务器和客户端的交互</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServer</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">MyServer</span><span class="params">()</span> &#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">startListen</span><span class="params">(<span class="type">int</span> port)</span> &#123;</span><br><span class="line">		<span class="type">Thread</span> <span class="variable">serverThread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerThread</span>(port);</span><br><span class="line">		serverThread.start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面是ServerThread的实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h16;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> port;</span><br><span class="line">	<span class="keyword">private</span> ServerSocket server;</span><br><span class="line">	<span class="keyword">private</span> Socket socket;</span><br><span class="line">	<span class="keyword">private</span> InputStream in;</span><br><span class="line">	<span class="keyword">private</span> OutputStream out;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">ServerThread</span><span class="params">(<span class="type">int</span> port)</span> &#123;</span><br><span class="line">		server = <span class="literal">null</span>;</span><br><span class="line">		socket = <span class="literal">null</span>;</span><br><span class="line">		in = <span class="literal">null</span>;</span><br><span class="line">		out = <span class="literal">null</span>;</span><br><span class="line">		<span class="built_in">this</span>.port = port;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(port);</span><br><span class="line">			socket = server.accept();</span><br><span class="line">			in = socket.getInputStream();</span><br><span class="line">			out = socket.getOutputStream();</span><br><span class="line">			</span><br><span class="line">			<span class="type">byte</span>[] data = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">100</span>];</span><br><span class="line">			<span class="type">int</span> <span class="variable">readed</span> <span class="operator">=</span> in.read(data);</span><br><span class="line">			<span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(data, <span class="number">0</span>, readed);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">while</span>(!(<span class="string">&quot;bye&quot;</span> + <span class="string">&quot;\r\n&quot;</span>).equals(line)) &#123;</span><br><span class="line">				out.write(line.getBytes());</span><br><span class="line">				readed = in.read(data);</span><br><span class="line">				line = <span class="keyword">new</span> <span class="title class_">String</span>(data, <span class="number">0</span>, readed);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;<span class="keyword">catch</span>(IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			close(server);</span><br><span class="line">			close(socket);</span><br><span class="line">			close(in);</span><br><span class="line">			close(out);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(AutoCloseable closeable)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (closeable != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                closeable.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>核心部分如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">server = <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(port);</span><br><span class="line">socket = server.accept();</span><br><span class="line">in = socket.getInputStream();</span><br><span class="line">out = socket.getOutputStream();</span><br><span class="line"></span><br><span class="line"><span class="type">byte</span>[] data = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">100</span>];</span><br><span class="line"><span class="type">int</span> <span class="variable">readed</span> <span class="operator">=</span> in.read(data);</span><br><span class="line"><span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(data, <span class="number">0</span>, readed);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(!(<span class="string">&quot;bye&quot;</span> + <span class="string">&quot;\r\n&quot;</span>).equals(line)) &#123;</span><br><span class="line">    out.write(line.getBytes());</span><br><span class="line">    readed = in.read(data);</span><br><span class="line">    line = <span class="keyword">new</span> <span class="title class_">String</span>(data, <span class="number">0</span>, readed);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务器用<code>accept</code>一直等待客户端，每次都通过<code>read</code>函数读取100字节大小的内容，<code>readed</code>来记录读取具体的字节数，然后构造一个字符串，比较这个字符串是否是<code>bye</code>，如果不是则重复进行上述操作</p>
<h1 id="h17"><a href="#h17" class="headerlink" title="h17"></a>h17</h1><p><strong>任务</strong>：</p>
<p>这次作业是实现小游戏的Pro版，比之前的游戏（h05~h07）增加了通过BattleField.init(String fileName)从从配置文件中初始化</p>
<p>在Test里面，还有Player这个对象，可以知道，新增了多个玩家同时玩这个游戏的功能</p>
<p>在方法实现层面，多了一个无参数的<code>attack</code>的构造方法，即寻找距离他最近、非己方、且活着的对象B进行攻击，如果攻击范围内没有符合要求对象则什么也不做。</p>
<p><strong>做法</strong>：</p>
<h2 id="1-枚举类"><a href="#1-枚举类" class="headerlink" title="1.枚举类"></a>1.枚举类</h2><p>首先把所有用到的“名词”都列到枚举类中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h17;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">EnumObjectType</span> &#123;</span><br><span class="line">	base,</span><br><span class="line">	health,</span><br><span class="line">	strength,</span><br><span class="line">	range,</span><br><span class="line">	heavyTank,</span><br><span class="line">	mediumTank,</span><br><span class="line">	rifleSoldier,</span><br><span class="line">	RPGSoldier,</span><br><span class="line">	dog,</span><br><span class="line">	barrack,</span><br><span class="line">	warFactory</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们实现读配置文件，这里的做法是把配置文件的所有信息读到一个参数类中，然后用到该信息的时候（如创建对象时）直接从这个参数类中读取信息</p>
<p>配置文件部分如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#测试的时候，属性的整数值可能会改变</span></span><br><span class="line">base.health=<span class="number">1000</span> </span><br><span class="line">base.<span class="built_in">range</span>=<span class="number">0</span></span><br><span class="line">base.strength=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#重型坦克的属性</span></span><br><span class="line">heavyTank.health=<span class="number">500</span></span><br><span class="line">heavyTank.<span class="built_in">range</span>=<span class="number">100</span></span><br><span class="line">heavyTank.strength=<span class="number">100</span></span><br></pre></td></tr></table></figure>

<p>在BattleField.java中，我定义了两个方法，一个是<code>readLine</code>用来读文件，一个是<code>setValue</code>用来把读到的具体数值写到参数类中。</p>
<h2 id="2-参数类（简略版）"><a href="#2-参数类（简略版）" class="headerlink" title="2.参数类（简略版）"></a>2.参数类（简略版）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h17;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Param</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">baseHealth</span> <span class="operator">=</span><span class="number">0</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">baseRange</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">baseStrength</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">heavyTankHealth</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">heavyTankRange</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">heavyTankStrength</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">mediumTankHealth</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">mediumTankRange</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">mediumTankStrength</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<h2 id="3-Battlefield类"><a href="#3-Battlefield类" class="headerlink" title="3.Battlefield类"></a>3.Battlefield类</h2><p><code>readLine</code>方法的实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;String[]&gt; readLines(String filename)&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">Reader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    List&lt;String[]&gt; results = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>(filename);</span><br><span class="line">    &#125;<span class="keyword">catch</span>(FileNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(reader == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">LineNumberReader</span> <span class="variable">lineReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LineNumberReader</span>(reader);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">            line = lineReader.readLine();</span><br><span class="line">            <span class="keyword">if</span>(line == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(line.trim().length()==<span class="number">0</span> || line.trim().startsWith(<span class="string">&quot;#&quot;</span>)) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            results.add(line.trim().split(<span class="string">&quot;\\.|=&quot;</span>));		<span class="comment">//注意反斜杠本身也要转义</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意，这里也可用用BufferedReader来代替，即</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>(<span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(filename)))&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>setValue</code>实现如下（简略版）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(String[] rules)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(EnumObjectType.base.toString().equals(rules[<span class="number">0</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(EnumObjectType.health.toString().equals(rules[<span class="number">1</span>])) &#123;</span><br><span class="line">            Param.baseHealth = Integer.parseInt(rules[<span class="number">2</span>]);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(EnumObjectType.strength.toString().equals(rules[<span class="number">1</span>])) &#123;</span><br><span class="line">            Param.baseStrength = Integer.parseInt(rules[<span class="number">2</span>]);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(EnumObjectType.range.toString().equals(rules[<span class="number">1</span>])) &#123;</span><br><span class="line">            Param.baseRange = Integer.parseInt(rules[<span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(EnumObjectType.heavyTank.toString().equals(rules[<span class="number">0</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(EnumObjectType.health.toString().equals(rules[<span class="number">1</span>])) &#123;</span><br><span class="line">            Param.heavyTankHealth = Integer.parseInt(rules[<span class="number">2</span>]);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(EnumObjectType.strength.toString().equals(rules[<span class="number">1</span>])) &#123;</span><br><span class="line">            Param.heavyTankStrength = Integer.parseInt(rules[<span class="number">2</span>]);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(EnumObjectType.range.toString().equals(rules[<span class="number">1</span>])) &#123;</span><br><span class="line">            Param.heavyTankRange = Integer.parseInt(rules[<span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>

<p>然后，便可以写出<code>init</code>方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(String filename)</span> &#123;</span><br><span class="line">    List&lt;String[]&gt; rules = readLines(filename);</span><br><span class="line">    <span class="keyword">if</span>(rules == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(String[] rule : rules) &#123;</span><br><span class="line">        setValue(rule);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BattleField.java实际上是维护了一个类型为Player的List列表，因此Battlefield.java中剩下的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h17;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BattleField</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> List&lt;Player&gt; players = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">BattleField</span><span class="params">()</span> &#123;</span><br><span class="line">		players = <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">        </span><br><span class="line">    	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">createPlayer</span><span class="params">(String playerName)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(playerName == <span class="literal">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">Player</span> <span class="variable">newPlayer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Player</span>(playerName);</span><br><span class="line">		players.add(newPlayer);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> GameBase <span class="title function_">createGameBase</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GameBase</span>(p,x,y);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> List&lt;Player&gt; <span class="title function_">getAllPlayer</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> players;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-Player类的实现"><a href="#4-Player类的实现" class="headerlink" title="4.Player类的实现"></a>4.Player类的实现</h2><p>Player的实现较为简单，只有一个<code>name</code>属性，还有对应的getter和setter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h17;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Player</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Player</span><span class="params">(String name)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-GameObject的实现"><a href="#5-GameObject的实现" class="headerlink" title="5.GameObject的实现"></a>5.GameObject的实现</h2><p>这个类里面完成了主要的游戏功能和逻辑，所以包含所有对象的属性，如果有具体对象属性不匹配（比如建筑物的攻击力等等），把对应的属性值设置为0即可。如果有具体对象的方法不匹配或者功能不全面，在对应的子类中重写该方法即可。</p>
<p>除了之前简单版本游戏中定义的五个属性（x,y,PH,attackValue,attackRange）之外，还有玩家信息（Player p）、<code>List&lt;GameObject&gt; gameObjects</code>存储所有对象（无参攻击时会检索周围所有的对象）、<code>EnumObjectType objectType</code>存储当前对象的类别，在打印<code>result.txt</code>会用到</p>
<p>此外，每次攻击后还需要打印（到控制台）相关的攻击信息（具体见result.txt）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h17;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GameObject</span> &#123;</span><br><span class="line">	<span class="keyword">protected</span> <span class="type">int</span> x,y;</span><br><span class="line">	<span class="keyword">protected</span> <span class="type">int</span> health;</span><br><span class="line">	<span class="keyword">protected</span> <span class="type">int</span> strength;</span><br><span class="line">	<span class="keyword">protected</span> <span class="type">int</span> range;</span><br><span class="line">	<span class="keyword">protected</span> Player player;</span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> List&lt;GameObject&gt; gameObjects = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">	<span class="keyword">protected</span> EnumObjectType objectType;		<span class="comment">//定义这个属性是为了在打印时打印出类别</span></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">GameObject</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> PH, <span class="type">int</span> attackValue, <span class="type">int</span> attackRange)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.player = p;</span><br><span class="line">		<span class="built_in">this</span>.x = x;</span><br><span class="line">		<span class="built_in">this</span>.y = y;</span><br><span class="line">		<span class="built_in">this</span>.health = PH;</span><br><span class="line">		<span class="built_in">this</span>.strength = attackValue;</span><br><span class="line">		<span class="built_in">this</span>.range = attackRange;</span><br><span class="line">		GameObject.gameObjects.add(<span class="built_in">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;			<span class="comment">//在result.txt中打印</span></span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;[&quot;</span>+player.getName()+<span class="string">&quot;.&quot;</span>+objectType+<span class="string">&quot; live=&quot;</span>+(!isDestroyed())+<span class="string">&quot; x=&quot;</span>+x+<span class="string">&quot; y=&quot;</span>+y+<span class="string">&quot; health=&quot;</span>+getHealth()+<span class="string">&quot;]&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">(<span class="type">int</span> dx, <span class="type">int</span> dy)</span> &#123;		<span class="comment">//building不能移动，所以在building中重写</span></span><br><span class="line">		<span class="built_in">this</span>.x += dx;</span><br><span class="line">		<span class="built_in">this</span>.y += dy;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getDistance</span><span class="params">(GameObject obj1, GameObject obj2)</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> Math.sqrt(Math.pow(obj1.x-obj2.x, <span class="number">2</span>)+Math.pow(obj1.y-obj2.y, <span class="number">2</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">(GameObject B)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">this</span>.isDestroyed() || B.isDestroyed() || getDistance(<span class="built_in">this</span>,B)&gt;<span class="built_in">this</span>.range) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">String</span> <span class="variable">debug</span> <span class="operator">=</span> <span class="built_in">this</span> + <span class="string">&quot;攻击&quot;</span>+B;</span><br><span class="line">		B.health -= <span class="built_in">this</span>.strength;</span><br><span class="line">		debug += <span class="string">&quot;攻击后 health=&quot;</span>+B.getHealth();</span><br><span class="line">		System.out.println(debug);				<span class="comment">//在result.txt中打印</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">double</span> <span class="variable">min</span> <span class="operator">=</span> <span class="built_in">this</span>.range;</span><br><span class="line">		<span class="keyword">for</span>(GameObject g: gameObjects) &#123;</span><br><span class="line">			<span class="keyword">if</span>(g.isDestroyed() || <span class="built_in">this</span>.isDestroyed()) &#123;</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(getDistance(<span class="built_in">this</span>,g) &lt; min) &#123;</span><br><span class="line">				min = getDistance(<span class="built_in">this</span>,g);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(GameObject g: gameObjects) &#123;</span><br><span class="line">			<span class="keyword">if</span>(g.isDestroyed() || <span class="built_in">this</span>.isDestroyed()) &#123;</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(getDistance(<span class="built_in">this</span>,g) - min &lt; <span class="number">0.000001</span>) &#123;</span><br><span class="line">				attack(g);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getHealth</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.health;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isDestroyed</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.health&lt;=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setObjectType</span><span class="params">(EnumObjectType type)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.objectType = type;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dead</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="comment">//在Soldier类中重写</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-其他各类"><a href="#6-其他各类" class="headerlink" title="6.其他各类"></a>6.其他各类</h2><p>其他各种类和之前的类似，唯一需要增加的就是每次构造完对象后都需要设置类型，树形图表示如下：</p>
<p><img src="/2024/04/19/java%E4%BD%9C%E4%B8%9A/image-20240427183859315.png" alt="image-20240427183859315"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h17;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GameBase</span> <span class="keyword">extends</span> <span class="title class_">GameObject</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">GameBase</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(p,x,y,Param.baseHealth,Param.baseStrength,Param.baseRange);</span><br><span class="line">		setObjectType(EnumObjectType.base);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> Building <span class="title function_">building</span><span class="params">(EnumObjectType type, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;		<span class="comment">//基地创建建筑物时可以指定x和y</span></span><br><span class="line">		<span class="keyword">if</span>(type == EnumObjectType.barrack) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Barrack</span>(<span class="built_in">this</span>.player, x, y);</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(type == EnumObjectType.warFactory) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">WarFactory</span>(<span class="built_in">this</span>.player, x, y);</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在写Building类时，要重写move方法，因为建筑物不能移动</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Building</span> <span class="keyword">extends</span> <span class="title class_">GameObject</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Building</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> PH, <span class="type">int</span> attackValue, <span class="type">int</span> attackRange)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(p,x,y,PH,attackValue,attackRange);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">(<span class="type">int</span> dx, <span class="type">int</span> dy)</span> &#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>兵营Barrack产生各种士兵和狗</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Barrack</span> <span class="keyword">extends</span> <span class="title class_">Building</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Barrack</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(p,x,y,Param.barrackHealth,Param.barrackStrengh,Param.barrackRange);</span><br><span class="line">		setObjectType(EnumObjectType.barrack);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> GameObject <span class="title function_">traing</span><span class="params">(EnumObjectType type)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(type == EnumObjectType.rifleSoldier) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RifleSoldier</span>(<span class="built_in">this</span>.player, <span class="built_in">this</span>.x, <span class="built_in">this</span>.y);</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(type == EnumObjectType.RPGSoldier) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RPGSoldier</span>(<span class="built_in">this</span>.player, <span class="built_in">this</span>.x, <span class="built_in">this</span>.y);</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(type == EnumObjectType.dog) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="built_in">this</span>.player, <span class="built_in">this</span>.x, <span class="built_in">this</span>.y);</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>两个士兵都继承自父类Soldier</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Soldier</span> <span class="keyword">extends</span> <span class="title class_">GameObject</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">livingSoldierCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">deadedSoldierCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Soldier</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> PH , <span class="type">int</span> attackValue, <span class="type">int</span> attackRange)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(p,x,y,PH,attackValue,attackRange);</span><br><span class="line">		livingSoldierCount++;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getLivingSoldierCount</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> livingSoldierCount;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDeadedSoldierCount</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> deadedSoldierCount;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dead</span><span class="params">()</span> &#123;</span><br><span class="line">		livingSoldierCount--;</span><br><span class="line">		deadedSoldierCount++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RifleSoldier</span> <span class="keyword">extends</span> <span class="title class_">Soldier</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">RifleSoldier</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(p,x,y,Param.rifleSoldierHealth,Param.rifleSoldierStrength,Param.rifleSoldierRange);</span><br><span class="line">		setObjectType(EnumObjectType.rifleSoldier);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RPGSoldier</span> <span class="keyword">extends</span> <span class="title class_">Soldier</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">RPGSoldier</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(p,x,y,Param.RPGSoldierHealth,Param.RPGSoldierStrength,Param.RPGSoldierRange);</span><br><span class="line">		setObjectType(EnumObjectType.RPGSoldier);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>狗直接继承GameObject类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_">GameObject</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Dog</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(p,x,y,Param.dogHealth,Param.dogStrength,Param.dogRange);</span><br><span class="line">		setObjectType(EnumObjectType.dog);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>兵工厂产生两种类型的Tank</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WarFactory</span> <span class="keyword">extends</span> <span class="title class_">Building</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">WarFactory</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(p,x,y,Param.warFactoryHealth,Param.warFactoryStrengh,Param.warFactoryRange);</span><br><span class="line">		setObjectType(EnumObjectType.warFactory);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> Tank <span class="title function_">building</span><span class="params">(EnumObjectType type)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(type == EnumObjectType.heavyTank) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HeavyTank</span>(<span class="built_in">this</span>.player,<span class="built_in">this</span>.x, <span class="built_in">this</span>.y);</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(type == EnumObjectType.mediumTank) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MediumTank</span>(<span class="built_in">this</span>.player, <span class="built_in">this</span>.x, <span class="built_in">this</span>.y);</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HeavyTank</span> <span class="keyword">extends</span> <span class="title class_">Tank</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">HeavyTank</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(p,x,y,Param.heavyTankHealth,Param.heavyTankStrength,Param.heavyTankRange);</span><br><span class="line">		setObjectType(EnumObjectType.heavyTank);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MediumTank</span> <span class="keyword">extends</span> <span class="title class_">Tank</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">MediumTank</span><span class="params">(Player p, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>(p,x,y,Param.mediumTankHealth,Param.mediumTankStrength,Param.mediumTankRange);</span><br><span class="line">		setObjectType(EnumObjectType.mediumTank);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h18"><a href="#h18" class="headerlink" title="h18"></a>h18</h1><p>首先补充一下正则表达式的知识</p>
<p><strong>基本匹配</strong>：</p>
<p>正则表达式a.c中间的.可以且仅限匹配一个字符</p>
<p><code>\d</code>仅限单个数字字符，而<code>\D</code>则匹配一个非数字。</p>
<p>用<code>\w</code>可以匹配一个字母、数字或下划线，w的意思是word。</p>
<p>用<code>\s</code>可以匹配一个空格字符，注意空格字符不但包括空格<code> </code>，还包括tab字符（在Java中用<code>\t</code>表示）。</p>
<p>修饰符<code>*</code>可以匹配任意个字符（包括0个）如<code>A\d*</code>，修饰符<code>+</code>可以匹配至少一个字符，如<code>A\d+</code>。</p>
<p>如果我们想精确指定n个字符怎么办？用修饰符<code>&#123;n&#125;</code>就可以。如<code>A\d&#123;3&#125;</code></p>
<p>如果我们想指定匹配n~m个字符怎么办？用修饰符<code>&#123;n,m&#125;</code>就可以。如<code>A\d&#123;3,5&#125;</code></p>
<p>如果没有上限，那么修饰符<code>&#123;n,&#125;</code>就可以匹配至少n个字符。</p>
<p><strong>匹配开头和结尾</strong></p>
<p>用正则表达式进行多行匹配时，我们用<code>^</code>表示开头，<code>$</code>表示结尾。例如，<code>^A\d&#123;3&#125;$</code>，可以匹配<code>&quot;A001&quot;</code>、<code>&quot;A380&quot;</code>。</p>
<p><strong>匹配指定范围</strong></p>
<p>要匹配大小写不限的6位十六进制数，比如<code>1A2b3c</code>，我们可以这样写：<code>[0-9a-fA-F]&#123;6&#125;</code></p>
<p><strong>或规则</strong></p>
<p>用<code>|</code>连接的两个正则规则是<em>或</em>规则，例如，<code>AB|CD</code>表示可以匹配<code>AB</code>或<code>CD</code>。</p>
<p><strong>使用括号</strong></p>
<p>现在我们想要匹配字符串<code>learn java</code>、<code>learn php</code>和<code>learn go</code>怎么办？可表示成<code>learn\\s(java|php|go)</code>。</p>
<p><strong>任务</strong>：</p>
<p>h18主要是考察反射</p>
<p>？？？</p>
<p><strong>做法</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h18;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClassFactory</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Map&lt;String, Object&gt;&gt; classConfigs = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyClassFactory</span><span class="params">(String configFilePath)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(configFilePath), <span class="string">&quot;UTF-8&quot;</span>))) &#123;</span><br><span class="line">            String line;</span><br><span class="line">            <span class="keyword">while</span> ((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                line = line.trim();</span><br><span class="line">                <span class="keyword">if</span> (line.isEmpty() || line.startsWith(<span class="string">&quot;#&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>; <span class="comment">// 跳过空行和注释行</span></span><br><span class="line">                &#125;</span><br><span class="line">                String[] parts = line.split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> parts[<span class="number">0</span>].trim();</span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> parts[<span class="number">1</span>].trim().replaceAll(<span class="string">&quot;^\&quot;|\&quot;$&quot;</span>, <span class="string">&quot;&quot;</span>); <span class="comment">// 去除开头和结尾的双引号</span></span><br><span class="line">                String[] classAndProperty = key.split(<span class="string">&quot;\\.(?=[^\\.]+$)&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> classAndProperty[<span class="number">0</span>];			<span class="comment">//类名</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">propertyName</span> <span class="operator">=</span> classAndProperty[<span class="number">1</span>];		<span class="comment">//属性名</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// 根据值是否以引号包围来判断是否为字符串</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">typedValue</span> <span class="operator">=</span> parts[<span class="number">1</span>].startsWith(<span class="string">&quot;\&quot;&quot;</span>) &amp;&amp; parts[<span class="number">1</span>].endsWith(<span class="string">&quot;\&quot;&quot;</span>) ? value : Integer.parseInt(value);</span><br><span class="line"></span><br><span class="line">                classConfigs.computeIfAbsent(className, k -&gt; <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;()).put(propertyName, typedValue);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">createInstance</span><span class="params">(Class&lt;T&gt; clazz)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">instance</span> <span class="operator">=</span> clazz.getDeclaredConstructor().newInstance();</span><br><span class="line">        Map&lt;String, Object&gt; properties = classConfigs.get(clazz.getName());</span><br><span class="line">        <span class="keyword">if</span> (properties != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; entry : properties.entrySet()) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">propName</span> <span class="operator">=</span> entry.getKey();</span><br><span class="line">                <span class="type">Object</span> <span class="variable">propValue</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line">                <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> <span class="string">&quot;set&quot;</span> + propName.substring(<span class="number">0</span>, <span class="number">1</span>).toUpperCase() + propName.substring(<span class="number">1</span>);		<span class="comment">//例如setColor</span></span><br><span class="line">                <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getMethod(methodName, propValue.getClass());</span><br><span class="line">                method.invoke(instance, propValue);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述代码有几点注意事项，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String[] classAndProperty = key.split(<span class="string">&quot;\\.(?=[^\\.]+$)&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>首先这句话是正则表达式+<a href = "https://www.runoob.com/w3cnote/reg-lookahead-lookbehind.html" target = "_blank">正向先行断言</a></p>
<p>代表匹配从开头到结尾出现的<code>.</code>中的最后一个<code>.</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">classConfigs.computeIfAbsent(className, k -&gt; <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;()).put(propertyName, typedValue);</span><br></pre></td></tr></table></figure>

<p>这里是调用了一个Map中的<code>computeIfAbsent</code>方法，检查是否有<code>className</code>，如果有，则返回对应的value值（还是一个Map）；如果没有，则构造一个新的className到value的映射关系（这里用到了lambda表达式），然后把对应的属性名和属性值放进去</p>
<p>接下来就是创建一个实例</p>
<p>实现通过</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">T</span> <span class="variable">instance</span> <span class="operator">=</span> clazz.getDeclaredConstructor().newInstance();</span><br></pre></td></tr></table></figure>

<p>创建一个无参构造实例</p>
<p>接下来读取上面的配置信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; properties = classConfigs.get(clazz.getName());</span><br></pre></td></tr></table></figure>

<p>将该类下的所有属性以及对应的值存放到Map中</p>
<p>然后就是遍历Map，获得属性名和属性值，通过属性名构造方法的名字，然后</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getMethod(methodName, propValue.getClass());</span><br></pre></td></tr></table></figure>

<p>通过<code>getMethod</code>获得该方法名和指定参数类型对应的方法，最后通过</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">method.invoke(instance, propValue);</span><br></pre></td></tr></table></figure>

<p><code>invoke</code>函数传入实例和方法参数，来设置实例的相关属性</p>
<h1 id="h19"><a href="#h19" class="headerlink" title="h19"></a>h19</h1><p>h19又返璞归真了，回到了之前简单的问题，总共有五个小任务，这里只介绍后两个</p>
<p><strong>任务1</strong>：</p>
<p>完成StrUtil类，其中的removeDulpicatedChar()方法可以去掉一个字符串中的重复字符，重复出现的字符只保留一个，并仍然按原来的顺序输出</p>
<p><strong>做法</strong>：</p>
<p>利用集合去重的方法，但是一般的集合是无序的，所以采用LinkedHashSet。</p>
<p>遍历集合时，采用Iterator来进行遍历，每次用next()函数取出每个元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">removeDulpicatedChar</span><span class="params">(String string)</span> &#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">    Set&lt;Character&gt; UniqueEle = <span class="keyword">new</span> <span class="title class_">LinkedHashSet</span>&lt;&gt;();		<span class="comment">//使用Linked保留原来的顺序</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;string.length();i++) &#123;</span><br><span class="line">        UniqueEle.add(string.charAt(i));</span><br><span class="line">    &#125;</span><br><span class="line">    Iterator&lt;Character&gt; it = UniqueEle.iterator();</span><br><span class="line">    <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span>(it.hasNext()) &#123;</span><br><span class="line">        result += it.next();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意这里的result还可以用StringBuild，每次<code>append()</code>，返回<code>result.toString()</code>.</p>
<p><strong>任务2</strong>：</p>
<p>将所有学生姓名按总成绩从高到低排名，如果成绩并列则按语文从高到低排列，<br>如果语文成绩也相同，则按数学由高到低排列，如果数学成绩也相同，则按英语由高到低排列（不会出现总分相同&amp;&amp;语文相同&amp;&amp;数学相同&amp;&amp;英语相同情况)</p>
<p><strong>做法</strong>：</p>
<p>由于每个学生有语文、数学和英语三门成绩，所以要单独构造一个Student类，里面包含语文、数学和英语和总成绩，然后建立一个学生姓名（String）到Student类的映射关系</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h19.q05;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentUtil</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">		String name;</span><br><span class="line">		<span class="type">int</span> chineseScore;</span><br><span class="line">		<span class="type">int</span> mathScore;</span><br><span class="line">		<span class="type">int</span> engScore;</span><br><span class="line">		<span class="type">int</span> totalScore;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name)</span> &#123;</span><br><span class="line">			<span class="built_in">this</span>.name = name;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateScore</span><span class="params">(String subject, <span class="type">int</span> score)</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="string">&quot;语文&quot;</span>.equals(subject)) &#123;</span><br><span class="line">				<span class="built_in">this</span>.chineseScore += score;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;数学&quot;</span>.equals(subject)) &#123;</span><br><span class="line">				<span class="built_in">this</span>.mathScore += score;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;英语&quot;</span>.equals(subject)) &#123;</span><br><span class="line">				<span class="built_in">this</span>.engScore += score;</span><br><span class="line">			&#125;</span><br><span class="line">			totalScore += score;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> List&lt;String&gt; <span class="title function_">sort</span><span class="params">(String fileName)</span>&#123;</span><br><span class="line">		Map&lt;String,Student&gt; stu = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();		<span class="comment">//建立学生姓名和学生之间的关系</span></span><br><span class="line">		<span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(fileName);</span><br><span class="line">		<span class="keyword">try</span> (<span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(file)))&#123;</span><br><span class="line">			<span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">			<span class="keyword">while</span>((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">				String parts[] = line.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">				<span class="keyword">if</span>(parts.length == <span class="number">3</span>) &#123;</span><br><span class="line">					<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> parts[<span class="number">0</span>].trim();</span><br><span class="line">					<span class="type">String</span> <span class="variable">subject</span> <span class="operator">=</span> parts[<span class="number">1</span>].trim();</span><br><span class="line">					<span class="type">int</span> <span class="variable">score</span> <span class="operator">=</span> Integer.parseInt(parts[<span class="number">2</span>].trim().substring(<span class="number">0</span>,<span class="number">2</span>));</span><br><span class="line">					<span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> stu.getOrDefault(name, <span class="keyword">new</span> <span class="title class_">Student</span>(name));</span><br><span class="line">					student.updateScore(subject, score);</span><br><span class="line">					stu.put(name, student);			<span class="comment">//相当于把更新后放到Map中</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		List&lt;Student&gt; students = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(stu.values());		<span class="comment">//把Map中所有value构造List</span></span><br><span class="line">		students.sort((a,b)-&gt;&#123;</span><br><span class="line">			<span class="keyword">if</span>(a.totalScore != b.totalScore) &#123;</span><br><span class="line">				<span class="keyword">return</span> Integer.compare(b.totalScore, a.totalScore);</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(a.chineseScore != b.chineseScore) &#123;</span><br><span class="line">				<span class="keyword">return</span> Integer.compare(b.chineseScore, a.chineseScore);</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(a.mathScore != a.mathScore) &#123;</span><br><span class="line">				<span class="keyword">return</span> Integer.compare(b.mathScore, a.mathScore);</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> Integer.compare(b.engScore, a.engScore);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		</span><br><span class="line">		List&lt;String&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">		<span class="keyword">for</span>(Student s : students) &#123;</span><br><span class="line">			result.add(s.name);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>重点是排序方法，首先只有List能进行sort排序，所以先通过Map中的value值构造List列表，然后通过lambda函数从大到小进行排序（注意写法），最后返回结果。</p>
<h1 id="h20"><a href="#h20" class="headerlink" title="h20"></a>h20</h1><p><strong>任务</strong>：</p>
<p>定义合适的类、接口，使得下面的代码编译并能正确运行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;	</span><br><span class="line">    <span class="type">A</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">D</span>();</span><br><span class="line">    <span class="type">C</span> <span class="variable">c</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">D</span>();</span><br><span class="line">    <span class="type">D</span> <span class="variable">d</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">D</span>();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;pass 1&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">B</span> <span class="variable">b</span> <span class="operator">=</span> c;</span><br><span class="line">    System.out.println(<span class="string">&quot;pass 2&quot;</span>);</span><br><span class="line"></span><br><span class="line">    a = d;</span><br><span class="line">    System.out.println(<span class="string">&quot;pass 3&quot;</span>);</span><br><span class="line"></span><br><span class="line">    c=<span class="keyword">new</span> <span class="title class_">E</span>();</span><br><span class="line">    System.out.println(<span class="string">&quot;pass 4&quot;</span>);</span><br><span class="line"></span><br><span class="line">    a=<span class="keyword">new</span> <span class="title class_">A</span>();</span><br><span class="line">    <span class="keyword">if</span> (!(a <span class="keyword">instanceof</span> B)) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;pass 5&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!(c <span class="keyword">instanceof</span> A)) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;pass 6&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!(c <span class="keyword">instanceof</span> D)) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;pass 7&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>做法</strong>：</p>
<p><font color = "red">总结：能new出来的都是class而不是interface，右边的都是子类或者子接口</font></p>
<p>根据上面的结论，可以判断A、D、E都是class；B、C是interface</p>
<p>由<code> A a = new D()</code>和<code>C c = new D()</code>可以判断D是A的子类，是C的子接口</p>
<p>由<code>B b = c</code>可以判断，C是B的子接口</p>
<p>由<code>c=new E()</code>可判断，E是C的子接口</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">B</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">C</span> <span class="keyword">extends</span> <span class="title class_">B</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">D</span> <span class="keyword">extends</span> <span class="title class_">A</span> <span class="keyword">implements</span> <span class="title class_">C</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">E</span> <span class="keyword">implements</span> <span class="title class_">C</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意，同类型的是extends；类继承接口是implements</p>
<h1 id="h31"><a href="#h31" class="headerlink" title="h31"></a>h31</h1><h2 id="q02"><a href="#q02" class="headerlink" title="q02"></a>q02</h2><p><strong>任务</strong>：</p>
<p>list中每个元素存了一个字符串，请返回包含不同特殊字符 最多的字符串,所谓特殊字符在本题目中定义为如下9个字符：(~!@#$%^&amp;*) 不包括括号, 不会出现并列的情况</p>
<p><strong>做法</strong>：</p>
<p>这道题考察了map和set的使用，Map是用来表示每个字符串中特殊字符的个数，而set则是用来计算不同特殊字符的个数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Classq02</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> Set&lt;Character&gt; charSet = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(Arrays.asList(<span class="string">&#x27;~&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;@&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&#x27;*&#x27;</span>));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">findMaxDistinctCharWord</span><span class="params">(List&lt;String&gt; list)</span> &#123;</span><br><span class="line">		<span class="type">int</span> i, max;</span><br><span class="line">		<span class="type">String</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>();</span><br><span class="line">		Map&lt;String, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; list.size(); i++) &#123;</span><br><span class="line">			<span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> list.get(i);</span><br><span class="line">			<span class="keyword">if</span> (!map.containsKey(str)) &#123;</span><br><span class="line">				map.put(str, getDistinctCharCount(str));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		max = <span class="number">0</span>;</span><br><span class="line">		Set&lt;String&gt; stringSet = map.keySet();</span><br><span class="line">		<span class="keyword">for</span> (String str: stringSet) &#123;</span><br><span class="line">			<span class="keyword">if</span> (max &lt; map.get(str)) &#123;</span><br><span class="line">				max = map.get(str);</span><br><span class="line">				ans = str;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDistinctCharCount</span><span class="params">(String s)</span> &#123;</span><br><span class="line">		Set&lt;Character&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">		<span class="type">char</span>[] chars = s.toCharArray();</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">char</span> cha : chars) &#123;</span><br><span class="line">			<span class="keyword">if</span> (charSet.contains(cha)) &#123;</span><br><span class="line">				set.add(cha);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> set.size();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="q06"><a href="#q06" class="headerlink" title="q06"></a>q06</h2><p><strong>任务</strong>：</p>
<p>递归的计算一个目录子目录下包含的文件数量（不包括目录数量，仅仅包括文件数量）</p>
<p><strong>做法</strong>：</p>
<p>要注意File对象有多个构造函数，这是其中的两个</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File(String pathname);</span><br><span class="line">File(File parent, String child);</span><br></pre></td></tr></table></figure>

<p>还要注意<code>exists()</code>,<code>isDirectory()</code>,<code>list()</code>函数的使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Classq06</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Classq06</span><span class="params">()</span> &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">recursiveGetFileCount</span><span class="params">(String homeDir)</span> &#123;</span><br><span class="line">		 <span class="comment">// </span></span><br><span class="line">		File dir=<span class="keyword">new</span> <span class="title class_">File</span>(homeDir);</span><br><span class="line">		ListFiles(dir);</span><br><span class="line">		<span class="keyword">return</span> count;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ListFiles</span><span class="params">(File dir)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (!dir.exists() || !dir.isDirectory()) &#123;		<span class="comment">//dir不存在或dir不是目录</span></span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		String[] files = dir.list();		<span class="comment">//里面存放着每个文件名</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; files.length; i++) &#123;</span><br><span class="line">			<span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(dir, files[i]);		<span class="comment">//采用父级目录和文件名构造出路径</span></span><br><span class="line">			<span class="keyword">if</span> (file.isFile()) &#123;</span><br><span class="line">				count++;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;		</span><br><span class="line">				ListFiles(file); <span class="comment">// 对于子目录,进行递归调用</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="q10"><a href="#q10" class="headerlink" title="q10"></a>q10</h2><p><strong>任务</strong>：</p>
<p>fileName文件中以  “商品名称,数量,总金额” 格式存放了若干购物流水 文件中可能有空行 也可能有 注释行（#开头） 商品名称 数量 总金额 前后可能有空格<br>请完成sortByAmount方法 按每种商品累积销售数量从高到低排序，如果出现累积销售数量相同的情况请按每种商品累积销售金额排序由高到低排序<br>请完成sortByMoney方法 按每种商品累积销售金额从高到低排序，如果出现累积销售金额相同的情况请按每种商品累积销售数量由高到低排序 </p>
<p><strong>做法</strong>：</p>
<p><font color = "red">此题比较复杂，建议多看几遍</font></p>
<p>首先构造了一个<code>Item</code>类，用来存放name，amount，money。注意这个类实现了Comparable接口</p>
<p>Comparable是排序接口；若一个类实现了Comparable接口，就意味着“该类支持排序”。可以使用Arrays.sort()对改类进行排序</p>
<p>在该类中定义了<code>compareTo</code>方法来进行数量的比较，定义了<code>compareMTo</code>方法来进行金钱的比较</p>
<p>在 Java 中，compareTo 方法的返回值定义了排序顺序：<br><code>返回 1</code> 表示当前对象应该排在传入对象<code>之后</code>。<br><code>返回 -1 </code>表示当前对象应该排在传入对象<code>之前</code>。<br><code>返回 0 </code>表示两者<code>相等</code>。</p>
<p>Item.java类如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Item</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> amount;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> money;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Item</span><span class="params">(String name, <span class="type">int</span> amount, <span class="type">int</span> money)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.name = name;</span><br><span class="line">		<span class="built_in">this</span>.amount = amount;</span><br><span class="line">		<span class="built_in">this</span>.money = money;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Item</span><span class="params">(String name, String amount, String money)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>(name, Integer.valueOf(amount), Integer.valueOf(money));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> Item)) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">this</span>.amount &gt; ((Item) o).amount) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.amount == ((Item) o).amount) &#123;		<span class="comment">//升序排列</span></span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">this</span>.money &gt; ((Item) o).money) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.money == ((Item) o).money) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareMTo</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> Item)) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">this</span>.money &gt; ((Item) o).money) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.money == ((Item) o).money) &#123;		<span class="comment">//升序排列</span></span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">this</span>.amount &gt; ((Item) o).amount) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.amount == ((Item) o).amount) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font color = "red">Comparable重写compareTo，参数只有一个</font></p>
<p><font color = "red">Comparator重写compare，参数有两个</font></p>
<p>然后构造一个ItemComparator类用来比较两个Item的值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ItemComparator</span> <span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;Item&gt; &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> order;		<span class="comment">//通过order是否为-1来决定到底是数值比较还是金钱比较</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ItemComparator</span><span class="params">(<span class="type">int</span> order)</span> </span><br><span class="line">&#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="built_in">this</span>.order = order;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Item i1, Item i2)</span> </span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> -i1.compareTo(i2);		<span class="comment">//倒序排列</span></span><br><span class="line">        <span class="type">int</span> resultM=-i1.compareMTo(i2);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.order == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> resultM;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>classq10部分的主体有两个，一个是sortByAmount，一个是sortByMoney</p>
<p><font color = "red">注意在sort的参数为构造的Comparator</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;String&gt; <span class="title function_">sortByAmount</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">    <span class="comment">//return sort(fileName);</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    List&lt;String&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    List&lt;Item&gt; scoreLists = initScoreLists(fileName);</span><br><span class="line">    scoreLists.sort(<span class="keyword">new</span> <span class="title class_">ItemComparator</span>(-<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; scoreLists.size(); i++) &#123;</span><br><span class="line">        result.add(scoreLists.get(i).getName());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;String&gt; <span class="title function_">sortByMoney</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    List&lt;String&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    List&lt;Item&gt; scoreLists = initScoreLists(fileName);</span><br><span class="line">    scoreLists.sort(<span class="keyword">new</span> <span class="title class_">ItemComparator</span>(<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; scoreLists.size(); i++) &#123;</span><br><span class="line">        result.add(scoreLists.get(i).getName());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中比较关键的就是<code>initScoreLists</code>函数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Item&gt; <span class="title function_">initScoreLists</span><span class="params">(String filename)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    List&lt;String[]&gt; items = readLines(filename);		<span class="comment">//自己定义的逐行读文件函数，有模板</span></span><br><span class="line">    Set&lt;String&gt; nameSet = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    List&lt;Item&gt; itemList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; items.size(); i++) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">money</span> <span class="operator">=</span> <span class="number">0</span>, amount = <span class="number">0</span>;</span><br><span class="line">        List&lt;String&gt; itemLine = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(Arrays.asList(<span class="string">&quot;&quot;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;0&quot;</span>));</span><br><span class="line">        line2list(items.get(i), itemLine);		<span class="comment">//将String[]转化为List&lt;String&gt;</span></span><br><span class="line">        name = itemLine.get(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (nameSet.contains(name)) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;		<span class="comment">//注意是双重循环，所以要continue</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            nameSet.add(name);</span><br><span class="line">        &#125;</span><br><span class="line">        money += Integer.parseInt(itemLine.get(<span class="number">2</span>));</span><br><span class="line">        amount += Integer.parseInt(itemLine.get(<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; items.size(); j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (items.get(j)[<span class="number">0</span>].equals(name)) &#123;</span><br><span class="line">                line2list(items.get(j), itemLine);</span><br><span class="line">                money += Integer.parseInt(itemLine.get(<span class="number">2</span>));</span><br><span class="line">                amount += Integer.parseInt(itemLine.get(<span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Item</span> <span class="variable">item</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Item</span>(name, amount, money);</span><br><span class="line">        itemList.add(item);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> itemList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>line2list函数如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">line2list</span><span class="params">(String[] itemLine, List&lt;String&gt; itemList)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> itemLine[<span class="number">0</span>];</span><br><span class="line">    <span class="type">String</span> <span class="variable">amount</span> <span class="operator">=</span> itemLine[<span class="number">1</span>];</span><br><span class="line">    <span class="type">String</span> <span class="variable">money</span> <span class="operator">=</span> itemLine[<span class="number">2</span>];</span><br><span class="line">    itemList.set(<span class="number">0</span>, name);		<span class="comment">//设定指定位置的值</span></span><br><span class="line">    itemList.set(<span class="number">1</span>, amount);</span><br><span class="line">    itemList.set(<span class="number">2</span>, money);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>逐行读文件函数模板如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;String[]&gt; readLines(String filename) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">Reader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    List&lt;String[]&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>(filename);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (reader == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">LineNumberReader</span> <span class="variable">lineReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LineNumberReader</span>(reader);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            line = lineReader.readLine();</span><br><span class="line">            <span class="keyword">if</span> (line == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;&quot;</span>.equals(line) || line.charAt(<span class="number">0</span>) == <span class="string">&#x27;#&#x27;</span> || line.trim().length() == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            result.add(line.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).split(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="q11"><a href="#q11" class="headerlink" title="q11"></a>q11</h2><p><strong>任务1</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一问  完成Classq11.extractComment(String line)方法，具体要求见 Classq11.extractComment(String line)</span></span><br><span class="line">String line=<span class="string">&quot;String str=\&quot;he;/*test*/\&quot;;&quot;</span>;</span><br><span class="line"><span class="comment">//这行的Java代码对应如下：</span></span><br><span class="line"><span class="comment">//String str=&quot;he;/*test*/&quot;;</span></span><br><span class="line"><span class="comment">//System.out.println(util.extractComment(line));</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;&quot;</span>.equals(util.extractComment(line))) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;case 2 pass&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">line=<span class="string">&quot;String str=\&quot;he//\&quot;;//hi;&quot;</span>;</span><br><span class="line"><span class="comment">//这行的Java代码对应如下：</span></span><br><span class="line"><span class="comment">//String str=&quot;he//&quot;;//hi;</span></span><br><span class="line"><span class="comment">//System.out.println(util.extractComment(line));</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;hi;&quot;</span>.equals(util.extractComment(line))) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;case 3 pass&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>做法</strong>：</p>
<p>主要是掌握indexOf(str,beginIndex)函数和subString函数</p>
<p><font color = "red">注意”\“”</font>作为一个字符的字符串</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">extractComment</span><span class="params">(String line)</span> &#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated constructor stub //&#123;03e7c9a7b63b7c323243d92158ea746a&#125;</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">head</span> <span class="operator">=</span> <span class="number">0</span>, tail = <span class="number">0</span>, primePos = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">primePos1</span> <span class="operator">=</span> (line.indexOf(<span class="string">&quot;\&quot;&quot;</span>) == -<span class="number">1</span>) ? <span class="number">0</span> : line.indexOf(<span class="string">&quot;\&quot;&quot;</span>);</span><br><span class="line">    primePos = (primePos1 == <span class="number">0</span>) ? <span class="number">0</span> : line.indexOf(<span class="string">&quot;\&quot;&quot;</span>, primePos1+<span class="number">1</span>);</span><br><span class="line">    System.out.println(primePos);</span><br><span class="line">    System.out.println(primePos1);</span><br><span class="line">    <span class="keyword">if</span>(line.indexOf(<span class="string">&quot;/*&quot;</span>,primePos) != -<span class="number">1</span>) &#123;</span><br><span class="line">        head = line.indexOf(<span class="string">&quot;/*&quot;</span>,primePos)+<span class="number">2</span>;</span><br><span class="line">        tail = line.indexOf(<span class="string">&quot;*/&quot;</span>,primePos)-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> line.substring(head,tail);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(line.indexOf(<span class="string">&quot;//&quot;</span>,primePos) != -<span class="number">1</span>) &#123;</span><br><span class="line">        head = line.indexOf(<span class="string">&quot;//&quot;</span>,primePos)+<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> line.substring(head);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>任务2</strong>：</p>
<p>第二问 导数表达式和导数值的计算<br>fx是只包含有一个自变量 x 是表达式，表达式中仅仅包含 加(+)、减(-)、乘(*)、除(&#x2F;)、乘方(^ 且指数中不包含变量)，请写一个函数计算fx的导数<br>例如：(x-8)^2&#x2F;(x-2)<br> x^3+x^2+1<br> 6&#x2F;(x+1)+7&#x2F;(x+8)<br>String fx &#x3D; “x^2+6”;<br>第二问 1  请计算这个函数的导数表达式，表达式不唯一，例如 x+1 或者 1+x 或者 1 + x 都可以。<br>String dxe &#x3D; util.getDxExp(fx);<br>第二问 2  请计算这个函数在指定x值的导数值并返回</p>
<p><strong>做法</strong>：</p>
<p>？？？</p>
<h1 id="h51"><a href="#h51" class="headerlink" title="h51"></a>h51</h1><p><strong>任务</strong>：</p>
<p>@param total  红包总金额，以元为单位，精确到分，系统测试的时候保证总金额至少够每人分得1分钱<br>@param personCount 分红包的总人数&gt;0<br>@return 每个人分得的钱数<br>规则遵循微信分红包规则 例如：<br>要求 每人分得的钱数总和&#x3D;total<br>每个人分得钱数必须是正数，且不能少于1分</p>
<p><strong>做法</strong>：</p>
<p>完成这道题需要考虑两点</p>
<blockquote>
<p>1.以元为单位，精确到分</p>
</blockquote>
<p>这要求构造随机数的时候可以先整体*100，然后可以避免掉小数</p>
<blockquote>
<p>2.至少够每人分得1分钱</p>
</blockquote>
<p>这要求在生成随机数的时候先预先为每个人保留1分钱</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">double</span>[] getHongbao(<span class="type">double</span> total,<span class="type">int</span> personCount) &#123;</span><br><span class="line">    <span class="type">double</span> result[]=<span class="keyword">new</span> <span class="title class_">double</span>[personCount];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(personCount &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">totalCents</span> <span class="operator">=</span> (<span class="type">int</span>)Math.round(total*<span class="number">100</span>);</span><br><span class="line">    <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">remainCents</span> <span class="operator">=</span> totalCents - personCount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这里只分配两个人的</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;personCount-<span class="number">1</span>;i++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">randomCents</span> <span class="operator">=</span> random.nextInt(remainCents+<span class="number">1</span>);	<span class="comment">//[1,remainCents]</span></span><br><span class="line">        result[i] = (randomCents+<span class="number">1</span>)/<span class="number">100.0</span>;				<span class="comment">//这里包含了之前的1分钱</span></span><br><span class="line">        remainCents -= randomCents;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    result[personCount-<span class="number">1</span>] = (remainCents+<span class="number">1</span>)/<span class="number">100.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h52"><a href="#h52" class="headerlink" title="h52"></a>h52</h1><p><strong>任务</strong>：</p>
<p>将num进行质因数分解，将分解到的质因数放到Set里面返回</p>
<p><strong>做法</strong>：</p>
<p>关键是考虑好算法，本题可以将大于等于2的数num从2开始依次遍历，如果找到一个质数因子，就把这个因子放到结果集中，并把num去除掉该因子，然后再从2开始依次遍历寻找（因为因子2可能不止一个）。</p>
<p>注意该算法不可能存在遍历到非质数的情况，因为非质数肯定由质数因子构成（如4可以分解为2*2）</p>
<figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">public</span> <span class="keyword">Set</span>&lt;<span class="type">Integer</span>&gt; decompose(<span class="type">int</span> num) &#123;</span><br><span class="line">     <span class="keyword">Set</span>&lt;<span class="type">Integer</span>&gt; res = <span class="built_in">new</span> HashSet&lt;&gt;();</span><br><span class="line">     <span class="keyword">if</span>(num &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">     &#125;<span class="keyword">else</span> <span class="keyword">if</span>(num == <span class="number">1</span>) &#123;</span><br><span class="line">          res.<span class="keyword">add</span>(<span class="number">1</span>);</span><br><span class="line">     &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="type">int</span> i = <span class="number">2</span>;</span><br><span class="line">          <span class="keyword">while</span>(i &lt;= num) &#123;</span><br><span class="line">              <span class="keyword">if</span>(num % i == <span class="number">0</span>) &#123;</span><br><span class="line">                  res.<span class="keyword">add</span>(i);</span><br><span class="line">                  num = num/i;			//把i这个因数去掉，剩下的因子构成num</span><br><span class="line">                  i = <span class="number">2</span>;					//i每次从<span class="number">2</span>开始</span><br><span class="line">              &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                  i++;					//不可能出现不是质数的情况，因为因子已经从小到大考虑过了</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h53"><a href="#h53" class="headerlink" title="h53"></a>h53</h1><p><strong>任务</strong>：</p>
<p> 1对兔子出生以后经过180天可以生出一窝（2对）兔子，以后每隔90天繁殖一次生出一窝（2对）兔子<br>每对兔子的寿命是700天<br>@param startCount 第0天 开始的时候初生的兔子对数<br>@param days 经过的天份数<br>@return 目前系统中存活的兔子的对数</p>
<p><strong>做法</strong>：</p>
<p>首先要构造一个Rabbit类来存放每个兔子的年龄</p>
<p>整体框架是两层循环，外层是考虑从第0天到第days天，内层是考虑每一天所有的兔子年龄+1，以及它们是否繁殖，是否死亡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getLivingRabbit</span><span class="params">(<span class="type">int</span> startCount,<span class="type">int</span> days)</span> &#123;</span><br><span class="line">    List&lt;Rabbit&gt; rabbits = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;startCount;i++) &#123;</span><br><span class="line">        rabbits.add(<span class="keyword">new</span> <span class="title class_">Rabbit</span>(<span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">day</span> <span class="operator">=</span> <span class="number">1</span>; day &lt;= days ;day++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">initialSize</span> <span class="operator">=</span> rabbits.size();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; initialSize;i++) &#123;</span><br><span class="line">            <span class="type">Rabbit</span> <span class="variable">r</span> <span class="operator">=</span> rabbits.get(i);</span><br><span class="line">            r.age++;</span><br><span class="line">            <span class="keyword">if</span>(r.age &gt;= <span class="number">180</span> &amp;&amp; (r.age - <span class="number">180</span>) % <span class="number">90</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                rabbits.add(<span class="keyword">new</span> <span class="title class_">Rabbit</span>(<span class="number">0</span>));</span><br><span class="line">                rabbits.add(<span class="keyword">new</span> <span class="title class_">Rabbit</span>(<span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(r.age &gt; <span class="number">700</span>) &#123;</span><br><span class="line">                rabbits.remove(i);</span><br><span class="line">                i--;</span><br><span class="line">                initialSize--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> rabbits.size();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h54"><a href="#h54" class="headerlink" title="h54"></a>h54</h1><p><strong>任务</strong>：</p>
<p>判断一个口令是否是一个复杂度合法的口令，复杂度合法的口令有如下要求：<br>1  长度&gt;&#x3D;8<br>2 最少包含一个数字<br>3 最少包含一个小写英文字母<br>4 虽少包含一个大写英文字母<br>5 最少包含一个特殊字符 特殊字符定义为   ~!@#$%^&amp;*()_+</p>
<p><strong>做法</strong>：</p>
<p>注意本题不是考察正则表达式，所以考虑用字典的方式，把2,3,4,5这四个条件对应的出现次数存起来，如果出现的次数为0，那么口令不符合要求</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isValidPassword</span><span class="params">(String password)</span>&#123;</span><br><span class="line">    Map&lt;String, Integer&gt; res = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span>(password.length() &lt; <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    res.put(<span class="string">&quot;number&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    res.put(<span class="string">&quot;lowerCase&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    res.put(<span class="string">&quot;upperCase&quot;</span>,<span class="number">0</span>);</span><br><span class="line">    res.put(<span class="string">&quot;special&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;~!@#$%^&amp;*()_+&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt; password.length(); i++) &#123;</span><br><span class="line">        <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> password.charAt(i);</span><br><span class="line">        <span class="keyword">if</span>(c &gt; <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">            res.put(<span class="string">&quot;number&quot;</span>, res.getOrDefault(<span class="string">&quot;number&quot;</span>, <span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c &gt; <span class="string">&#x27;a&#x27;</span> &amp;&amp; c &lt; <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">            res.put(<span class="string">&quot;lowerCase&quot;</span>, res.getOrDefault(<span class="string">&quot;lowerCase&quot;</span>, <span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c &gt; <span class="string">&#x27;A&#x27;</span> &amp;&amp; c &lt; <span class="string">&#x27;Z&#x27;</span>) &#123;</span><br><span class="line">            res.put(<span class="string">&quot;upperCase&quot;</span>, res.getOrDefault(<span class="string">&quot;upperCase&quot;</span>, <span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(flag.contains(c + <span class="string">&quot;&quot;</span>)) &#123;			<span class="comment">//将字符转为字符串</span></span><br><span class="line">            res.put(<span class="string">&quot;special&quot;</span>, res.getOrDefault(<span class="string">&quot;special&quot;</span>, <span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isValid</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(Map.Entry&lt;String, Integer&gt; entry : res.entrySet()) &#123;</span><br><span class="line">        <span class="keyword">if</span>(entry.getValue() == <span class="number">0</span>) &#123;</span><br><span class="line">            isValid = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> isValid;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h55"><a href="#h55" class="headerlink" title="h55"></a>h55</h1><p><strong>任务</strong>：</p>
<p>用计算机来证明  为什么说李白是浪漫主义诗人 杜甫是现实主义诗人 </p>
<p>分析不同诗人使用一些汉字时候的特点 </p>
<p>1 分析不同诗人使用一个汉字的时候，将这些汉字组成什么词汇使用在诗句里面</p>
<p>2 按这些词汇出现的频率高低排序；</p>
<p>3 只要是两个汉字连起来就视为一个词。</p>
<p>@param pathFilename 包含诗歌内容的源文件<br>@param chars 需要统计的字 以半角分号分割</p>
<p><strong>做法</strong>：</p>
<p>将读到的字符串拆为一个词一个词的，然后判断是否是汉字，是否包含chars出现的内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">analysis</span><span class="params">(String pathFilename,String chars)</span> &#123;</span><br><span class="line">    Map&lt;String, Integer&gt; res = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(pathFilename);</span><br><span class="line">    <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(f));</span><br><span class="line">        <span class="keyword">while</span>((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;line.length()-<span class="number">1</span>;i++) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">word</span> <span class="operator">=</span> line.substring(i,i+<span class="number">2</span>);</span><br><span class="line">                <span class="keyword">if</span>(word.matches(<span class="string">&quot;[\\u4e00-\\u9fa5]&#123;2&#125;&quot;</span>) &amp;&amp; (chars.contains(word.substring(<span class="number">0</span>, <span class="number">1</span>)) || chars.contains(word.substring(<span class="number">1</span>, <span class="number">2</span>)))) &#123;		<span class="comment">//确保是两个汉字</span></span><br><span class="line">                    res.put(word, res.getOrDefault(word, <span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(Map.Entry&lt;String, Integer&gt; entry: res.entrySet()) &#123;</span><br><span class="line">        <span class="keyword">if</span>(maxCount &lt; entry.getValue()) &#123;</span><br><span class="line">            maxCount = entry.getValue();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> maxCount;i&gt;<span class="number">0</span>;i--) &#123;</span><br><span class="line">        <span class="keyword">for</span>(Map.Entry&lt;String, Integer&gt; entry : res.entrySet()) &#123;</span><br><span class="line">            <span class="keyword">if</span>(entry.getValue() == i) &#123;</span><br><span class="line">                System.out.println(entry.getKey() + <span class="string">&quot; &quot;</span>+ entry.getValue());</span><br><span class="line">                counter++;			<span class="comment">//只有打印出来了，计数器才+1</span></span><br><span class="line">                <span class="keyword">if</span>(counter==<span class="number">10</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(counter==<span class="number">10</span>) &#123;		<span class="comment">//防止打印出排名并列的从而超过10个</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h56"><a href="#h56" class="headerlink" title="h56"></a>h56</h1><p><strong>任务</strong>：</p>
<p>将homeDir 目录下（包括子目录）所有的文本文件（扩展名为.txt，扩展名不是.txt的文件不要动，扩展名区分大小写) 文件中，orgStr替换为 targetStr<br>所有文本文件均为UTF-8编码<br>例如将某个目录中所有文本文件中的 南开大学 替换为 天津大学<br>@param homeDir<br>@param orgStr<br>@param targetStr</p>
<p><strong>做法</strong>：</p>
<p>本题考察了两点，一个是递归的读文件，另外一个是BufferedReader和BufferedWriter的使用</p>
<p>经典递归读文件的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listFiles</span><span class="params">(File dir)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!dir.exists() || !dir.isDirectory()) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    String[] files = dir.list();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt; files.length ;i++) &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(dir,files[i]);		<span class="comment">//这里要加上根目录</span></span><br><span class="line">        <span class="keyword">if</span>(f.isFile() &amp;&amp; files[i].endsWith(<span class="string">&quot;.txt&quot;</span>)) &#123;</span><br><span class="line">            res.add(f);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            listFiles(f);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后注意BufferedReader的构造，FileInputStream-&gt;InputStreamReader-&gt;BufferedReader</p>
<p>BufferedWriter的构造，FileOutputStream-&gt;OutputStreamWriter-&gt;BufferedWriter</p>
<p>通过增加一个firstLine布尔值来判断是不是第一行，涉及到换行问题</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">replaceTxtFileContent</span><span class="params">(String homeDir,String orgStr,String targetStr)</span> &#123;</span><br><span class="line">    <span class="type">File</span> <span class="variable">dir</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(homeDir);</span><br><span class="line">    listFiles(dir);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;res.size();i++) &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> res.get(i);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(f),<span class="string">&quot;UTF-8&quot;</span>));		<span class="comment">//加入UTF-8防止乱码</span></span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">contents</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">firstLine</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">while</span>((line = reader.readLine()) != <span class="literal">null</span>) &#123;			<span class="comment">//把所有内容都读出来然后替换</span></span><br><span class="line">                <span class="keyword">if</span>(firstLine) &#123;</span><br><span class="line">                    contents.append(line.replace(orgStr, targetStr));</span><br><span class="line">                    firstLine = <span class="literal">false</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    contents.append(System.lineSeparator()).append(line.replace(orgStr, targetStr));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            reader.close();</span><br><span class="line"></span><br><span class="line">            <span class="type">BufferedWriter</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(f),<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            writer.write(contents.toString());			<span class="comment">//这里是覆盖写</span></span><br><span class="line">            writer.close();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h57"><a href="#h57" class="headerlink" title="h57"></a>h57</h1><p><strong>任务</strong>：</p>
<p>统计一个目录下所有文件大小的加和</p>
<p><strong>做法</strong>：</p>
<p>还是对经典读文件的考察，注意<code>file.length()</code>是返回文件的大小</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">long</span> <span class="variable">sizeSum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">public</span> <span class="type">long</span> <span class="title function_">recursiveCalcFileSize</span><span class="params">(String homeDir)</span> &#123;</span><br><span class="line">    <span class="type">File</span> <span class="variable">dir</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(homeDir);</span><br><span class="line">    listFiles(dir);</span><br><span class="line">    <span class="keyword">return</span> sizeSum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listFiles</span><span class="params">(File dir)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!dir.exists() || !dir.isDirectory()) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    String[] files = dir.list();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;files.length;i++) &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(dir, files[i]);</span><br><span class="line">        <span class="keyword">if</span>(f.isFile()) &#123;</span><br><span class="line">            sizeSum += f.length();			<span class="comment">//返回文件的大小</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            listFiles(f);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h58"><a href="#h58" class="headerlink" title="h58"></a>h58</h1><p><strong>任务</strong>：</p>
<p>fileName是一个投票的明细记录，里面逐行存放了 投票的时间（yyyy-MM-dd HH:mm:ss 格式） +\t+投票的微信ID+\t+候选人<br>存放按时间递增（但是可能出现同一秒出现若干条记录的情况）<br>现在需要完成投票统计的过程，具体要求如下：<br>1个微信ID 1分钟内 最多投1票 多余的票数无效<br>1个微信ID 10分钟内 最多只能投5票 多余的票无效<br>其中微信ID不固定，候选人姓名不固定<br>测试的时候要求10万行记录处理时间不超过3秒<br>@param fileName<br>@return 返回一个map，其中key是候选人名字，value的票数</p>
<p><strong>做法</strong>：</p>
<p>本题较为复杂，主要是去除不合法记录的算法需要理解</p>
<p>首先创建两个类，一个Record用来记录投票的时间、投票id，投选人，增加一个boolean值判断该记录是否合法；另外一个Voter类用来记录投票id，和每个投票id的Record（List列表）</p>
<p>注意Record实现Comparator，重写compareTo，比较时间的大小，按时间从小到大进行排序（虽然本题中已经排好）</p>
<p>Voter只要id相同即可认为相同，所以Voter实现Serializable，重写hashCode和equals方法，每个Voter对象的hashCode值为对应的id的hashCode的值，只要id的值相同则可认为是一个Voter</p>
<p>接下来是Voter类里面的<strong>去除不合法记录的算法</strong></p>
<p>为了保证10分钟内不能有同一投票者投票超过5次，所以先构造一个buffer数组，放入5个元素进去，用next变量来记录当前走到records中的位置，定义一个循环，只要next&lt;records.size()，那么先判断这个buffer内是否有不满足1分钟之内只能投一票的要求，注意每次都要更新i值和oneMinLater的值；然后判断buffer内是否有两个记录超过10min，如果有的话，移除第一个元素，添加records中的下一个元素（相当于buffer右移），注意这里还要针对没有添加元素成功的情况正确的更新i的值，<font color = "red">此处和1分钟那里不同的原因在于，1分钟是比较buffer中两两之间的时间间隔，而这里每次都是和buffer第一个元素比较</font>；最后，如果buffer外下一条记录在10min之内，直接设置该记录不合法即可。</p>
<p>为了保证不陷入死循环，每次判断完上述三个条件后，都需要移除第一个元素，添加下一个元素，即实现buffer的右移</p>
<p>这里还要进行最后一次判断1min，以为还可能存在最后一条记录不符合规范，如120min，120.5min，而这个120.5min恰好是最后一个记录，由于next &#x3D;&#x3D; records.size()，所以单独判断一次，这也是最后一次判断。10min的不用判断的原因是已经在上面的循环中判断过了</p>
<p>最后在VoterRecord.java中先通过写一个readLine函数读取所有的记录，根据所有的记录Records读出所有的id存入到一个Set中，根据Set中的所有元素构造一个List&lt;Voter&gt;。再用一个双重循环，遍历所有Voter，对每个Voter遍历所有Records，如果id相同则把该条记录放入到Voter中。最后遍历Voter，对每个Voter都去除不合法记录，把他的所有投票结果加入到Map&lt;候选人的名字，票数&gt;中</p>
<p>代码如下</p>
<p>Record.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h58;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Record</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Date time;</span><br><span class="line">	<span class="keyword">private</span> String id;</span><br><span class="line">	<span class="keyword">private</span> String name;		<span class="comment">//候选人的名字</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">boolean</span> isValid;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Record</span><span class="params">(String t, String id, String name)</span> &#123;</span><br><span class="line">		<span class="type">DateFormat</span> <span class="variable">fmt</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-DD HH:mm:ss&quot;</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="built_in">this</span>.time = fmt.parse(t);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">this</span>.id = id;</span><br><span class="line">		<span class="built_in">this</span>.name = name;</span><br><span class="line">		<span class="built_in">this</span>.isValid = <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> Date <span class="title function_">getDate</span><span class="params">()</span> &#123;			<span class="comment">//由于getTime是系统的函数，这里改为getDate</span></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.time;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.id;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValid</span><span class="params">(<span class="type">boolean</span> flag)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.isValid = flag;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">getIsValid</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.isValid;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(! (o <span class="keyword">instanceof</span> Record)) &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">Record</span> <span class="variable">that</span> <span class="operator">=</span> (Record)o;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.time.compareTo(that.time);			<span class="comment">//根据时间顺序排名记录</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Voter.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h58;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Voter</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String id;		<span class="comment">//不同投票者的区别是id不同</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;Record&gt; records = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Voter</span><span class="params">(String id)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addRecord</span><span class="params">(Record record)</span> &#123;</span><br><span class="line">		records.add(record);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.id;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> List&lt;Record&gt; <span class="title function_">getRecords</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.records;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeInvalidRecords</span><span class="params">()</span> &#123;</span><br><span class="line">		records.sort(Record:: compareTo);</span><br><span class="line">		</span><br><span class="line">		List&lt;Record&gt; buffer = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">		<span class="type">int</span> <span class="variable">next</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; Math.min(<span class="number">5</span>, records.size());i++) &#123;</span><br><span class="line">			buffer.add(records.get(next++));</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(next &lt; records.size())&#123;</span><br><span class="line">			<span class="type">Date</span> <span class="variable">curTime</span> <span class="operator">=</span> buffer.get(<span class="number">0</span>).getDate();</span><br><span class="line">			<span class="type">Date</span> <span class="variable">oneMinLater</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>(curTime.getTime()+<span class="number">60000</span>);</span><br><span class="line">			<span class="type">Date</span> <span class="variable">tenMinLater</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>(curTime.getTime()+<span class="number">600000</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; buffer.size() ;i++) &#123;</span><br><span class="line">				<span class="keyword">if</span>(buffer.get(i).getDate().compareTo(oneMinLater) &lt; <span class="number">0</span>) &#123;	<span class="comment">//在1min之内</span></span><br><span class="line">					buffer.get(i).setValid(<span class="literal">false</span>);</span><br><span class="line">					buffer.remove(i--);</span><br><span class="line">					<span class="keyword">if</span>(next &lt; records.size()) &#123;</span><br><span class="line">						buffer.add(records.get(next++));</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				oneMinLater = <span class="keyword">new</span> <span class="title class_">Date</span>(buffer.get(i).getDate().getTime()+<span class="number">60000</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span> ;i &lt;buffer.size();i++) &#123;</span><br><span class="line">				<span class="keyword">if</span>(buffer.get(i).getDate().compareTo(tenMinLater) &gt;= <span class="number">0</span>) &#123;		<span class="comment">//在10min之后</span></span><br><span class="line">					buffer.remove(<span class="number">0</span>);</span><br><span class="line">					<span class="keyword">if</span>(next &lt; records.size()) &#123;</span><br><span class="line">						buffer.add(records.get(next++));</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">if</span>(buffer.size() != <span class="number">5</span>) &#123;		<span class="comment">//针对没有添加元素成功的情况</span></span><br><span class="line">						i = buffer.size()-<span class="number">2</span>;</span><br><span class="line">					&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">						i--;</span><br><span class="line">					&#125;</span><br><span class="line">					tenMinLater = <span class="keyword">new</span> <span class="title class_">Date</span>(buffer.get(<span class="number">0</span>).getDate().getTime()+<span class="number">600000</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">while</span>(next &lt; records.size()) &#123;</span><br><span class="line">				<span class="keyword">if</span>(records.get(next).getDate().compareTo(tenMinLater) &lt; <span class="number">0</span>) &#123;		<span class="comment">//如果buffer外下一条记录在10min之内</span></span><br><span class="line">					records.get(next++).setValid(<span class="literal">false</span>);</span><br><span class="line">				&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(next &lt; records.size()) &#123;</span><br><span class="line">				buffer.remove(<span class="number">0</span>);</span><br><span class="line">				buffer.add(records.get(next++));</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//再次也是最后一次判断，防止最后一个元素不符合规范</span></span><br><span class="line">		<span class="keyword">if</span>(buffer.size() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="type">Date</span> <span class="variable">curTime</span> <span class="operator">=</span> buffer.get(<span class="number">0</span>).getDate();</span><br><span class="line">			<span class="type">Date</span> <span class="variable">oneMinLater</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>(curTime.getTime()+<span class="number">60000</span>);</span><br><span class="line">			<span class="type">Date</span> <span class="variable">tenMinLater</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>(curTime.getTime()+<span class="number">600000</span>);</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; buffer.size() ;i++) &#123;</span><br><span class="line">				<span class="keyword">if</span>(buffer.get(i).getDate().compareTo(oneMinLater) &lt; <span class="number">0</span>) &#123;	<span class="comment">//在1min之内</span></span><br><span class="line">					buffer.get(i).setValid(<span class="literal">false</span>);</span><br><span class="line">					buffer.remove(i--);</span><br><span class="line">				&#125;</span><br><span class="line">				oneMinLater = <span class="keyword">new</span> <span class="title class_">Date</span>(buffer.get(i).getDate().getTime()+<span class="number">60000</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> id.hashCode();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(!(o <span class="keyword">instanceof</span> Voter)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">Voter</span> <span class="variable">that</span> <span class="operator">=</span> (Voter) o;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.id.equals(that.id);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>VoterRecord.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h58;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VoteRecord</span> &#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * fileName是一个投票的明细记录，里面逐行存放了 投票的时间（yyyy-MM-dd HH:mm:ss 格式） +\t+投票的微信ID+\t+候选人</span></span><br><span class="line"><span class="comment">	 * 存放按时间递增（但是可能出现同一秒出现若干条记录的情况）</span></span><br><span class="line"><span class="comment">	 * 现在需要完成投票统计的过程，具体要求如下：</span></span><br><span class="line"><span class="comment">	 * 1个微信ID 1分钟内 最多投1票 多余的票数无效</span></span><br><span class="line"><span class="comment">	 * 1个微信ID 10分钟内 最多只能投5票 多余的票无效</span></span><br><span class="line"><span class="comment">	 * 其中微信ID不固定，候选人姓名不固定</span></span><br><span class="line"><span class="comment">	 * 测试的时候要求10万行记录处理时间不超过3秒 </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> fileName</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> 返回一个map，其中key是候选人名字，value的票数</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> List&lt;Voter&gt; voters = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> Map&lt;String,Integer&gt; <span class="title function_">calcRecording</span><span class="params">(String fileName)</span>&#123;</span><br><span class="line">		Map&lt;String, Integer&gt; res = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">		List&lt;Record&gt; allRecords = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">		Set&lt;String&gt; voterIds = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">		allRecords = readLines(fileName);</span><br><span class="line">		<span class="keyword">for</span>(Record rec : allRecords) &#123;</span><br><span class="line">			voterIds.add(rec.getId());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(String voterId : voterIds) &#123;</span><br><span class="line">			<span class="type">Voter</span> <span class="variable">vo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Voter</span>(voterId);</span><br><span class="line">			voters.add(vo);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(Voter v : voters) &#123;</span><br><span class="line">			<span class="keyword">for</span>(Record rec : allRecords) &#123;</span><br><span class="line">				<span class="keyword">if</span>(rec.getId().equals(v.getId())) &#123;</span><br><span class="line">					v.addRecord(rec);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(Voter v : voters) &#123;</span><br><span class="line">			v.removeInvalidRecords();</span><br><span class="line">			<span class="keyword">for</span>(Record r : v.getRecords()) &#123;</span><br><span class="line">				<span class="keyword">if</span>(r.getIsValid()) &#123;</span><br><span class="line">					res.put(r.getName(), res.getOrDefault(r.getName(), <span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> List&lt;Record&gt; <span class="title function_">readLines</span><span class="params">(String path)</span> &#123;</span><br><span class="line">		<span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line">		List&lt;Record&gt; res1 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(f));</span><br><span class="line">			<span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">			<span class="keyword">while</span>((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">				String[] elements = line.split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">				<span class="type">String</span> <span class="variable">time</span> <span class="operator">=</span> elements[<span class="number">0</span>];</span><br><span class="line">				<span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> elements[<span class="number">1</span>];</span><br><span class="line">				<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> elements[<span class="number">2</span>];</span><br><span class="line">				<span class="type">Record</span> <span class="variable">record</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Record</span>(time,id,name);</span><br><span class="line">				res1.add(record);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res1;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试Tips：可以先自己构造一个小的测试用例进行测试</p>
<h1 id="h59"><a href="#h59" class="headerlink" title="h59"></a>h59</h1><p><strong>任务</strong>：</p>
<p>本文件中存放了若干的化学反应方程式（总数量不会超过1000个）<br>某个文本本文件中存放了一系列的化学反应 #表示注释<br>化学反应以 &#x3D; 分为了左侧和右侧；不同化合物之间至少有 一个空格<br>A + B &#x3D; C + D 意味着体系中如果有了 A B 就可以生成C D，同样如果有C D 也可以生成 A B<br>所有反应 反应物前系数均为 1<br>根据一个体系中初始化合物 ，最后可能都存在什么化合物</p>
<p><strong>做法</strong>：</p>
<p>本题关键是要构造一个双映射关系，即可以通过反应物得知生成物，也可以通过生成物得到反应物</p>
<p>由于一个物质存在只能存在一种，所以用Set来记录反应物和生成物</p>
<p>然后根据已有的初始物质，遍历每一条反应，得到所有的物质</p>
<p>注意<code>containsAll()</code>和<code>addAll()</code>的用法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Reaction</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> Set&lt;String&gt; reactant = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">	<span class="keyword">private</span> Set&lt;String&gt; product = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Reaction</span><span class="params">(Set&lt;String&gt; reactant, Set&lt;String&gt; product)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.reactant = reactant;</span><br><span class="line">		<span class="built_in">this</span>.product = product;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">getReactant</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> reactant;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">getProduct</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> product;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">findAllComponents</span><span class="params">(String reactionFile,Set&lt;String&gt; initComponents)</span>&#123;</span><br><span class="line">    Set&lt;String&gt; result = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(initComponents);		<span class="comment">//初始化直接根据initComponents构建result</span></span><br><span class="line"></span><br><span class="line">    List&lt;Reaction&gt; reactions = readLines(reactionFile);</span><br><span class="line">    <span class="type">int</span> <span class="variable">addCount</span> <span class="operator">=</span> initComponents.size();</span><br><span class="line">    <span class="keyword">while</span>(addCount != <span class="number">0</span>) &#123;</span><br><span class="line">        addCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(Reaction rea : reactions) &#123;</span><br><span class="line">            <span class="keyword">if</span>(result.containsAll(rea.getReactant()) &amp;&amp; result.addAll(rea.getProduct())) &#123;</span><br><span class="line">                addCount++;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(result.containsAll(rea.getProduct()) &amp;&amp; result.addAll((rea.getReactant())))&#123;</span><br><span class="line">                addCount++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> List&lt;Reaction&gt; <span class="title function_">readLines</span><span class="params">(String reactionFile)</span>&#123;</span><br><span class="line">    List&lt;Reaction&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(reactionFile);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(f));</span><br><span class="line">        <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">while</span>((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(line.startsWith(<span class="string">&quot;#&quot;</span>) || line.trim().length() == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            String[] reaction = line.split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">left</span> <span class="operator">=</span> reaction[<span class="number">0</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">right</span> <span class="operator">=</span> reaction[<span class="number">1</span>];</span><br><span class="line">            String[] lefts = left.split(<span class="string">&quot;\\ \\+\\ &quot;</span>);	<span class="comment">//这里是正则表达式，如果只有一个反应物则返回值不变（不分割）</span></span><br><span class="line">            Set&lt;String&gt; leftSet = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span>(String ele : lefts) &#123;</span><br><span class="line">                leftSet.add(ele.trim());</span><br><span class="line">            &#125;</span><br><span class="line">            String[] rights = right.split(<span class="string">&quot;\\ \\+\\ &quot;</span>);</span><br><span class="line">            Set&lt;String&gt; rightSet = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span>(String ele : rights) &#123;</span><br><span class="line">                rightSet.add(ele.trim());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Reaction</span> <span class="variable">rea</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reaction</span>(leftSet,rightSet);</span><br><span class="line">            res.add(rea);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="h60"><a href="#h60" class="headerlink" title="h60"></a>h60</h1><p><strong>任务</strong>：</p>
<p>在ChatServer,ChatClient中增加适当代码，并增加适当的类，完成一个简单的聊天室<br>user.txt中存放了所有用户的用户名和口令 用\t分割</p>
<p><strong>做法</strong>：</p>
<p>首先要搞清楚服务器和客户端两者的代码模版，参考ch10.MyserverSocketV3.java、ch10.MyClientSocketV3.java和ch10.ServerThread.java</p>
<p>我的做法和上面的模板略有不同，我是在ChatServer里面写了一个内部类ClientHandler，实现Runnerable接口，然后再startListen中每次都用ClientHandler作为构造函数的参数新建线程并启动，注意这个方法每次调用startListen时，都要用lambda函数来启动一个新的线程（具体见代码）</p>
<p>所以，整体的框架是<font color = "red">ChatServer类中有一个内部类ClientHandler，在ChatServer中构建一个集合来存储所有的ClientHandler（便于读写操作和广播操作），ChatServer中实现功能的主要部分，包括登录用户名和口令的验证等等。ChatClient可以看做是一个专门用来接收in.readLine()和发送out.write()的工具</font></p>
<p>然后是实现思路的问题：</p>
<blockquote>
<p>1.如何实现客户端的登录和退出以及读写操作？</p>
</blockquote>
<p>我的方法是每当客户端要完成一个动作时都会先写指令给服务器，服务器得到指令后进行相应的判断和操作，最后返回给客户端相应的内容</p>
<blockquote>
<p>2.如何实现只有登录以后才可以读到,否则返回null</p>
</blockquote>
<p>这个可以在服务器中，具体来讲是ClientHandler定义一个boolean值loggedIn来判断是否登录成功，如果没有则不能进行相应的读写操作</p>
<blockquote>
<p>3.如何得到聊天室里面所有的发言（包括自己的）</p>
</blockquote>
<p><font color = "red">在ChatServer中构建一个消息列表，为每个ClientHandler分配一个消息索引指针</font>，注意这个列表是同步的并且要加锁。每当客户端发消息时，都把消息存储到这个列表中；当客户端读消息的时候，根据自己的消息索引指针来读取相应的内容。</p>
<p>我的做法还有相应的扩展，即新增了一个broadcastMessage方法用来广播系统消息（如“xxx has joined the chat”），区分系统消息和对话消息可以在消息前面加“SYSTEM”或“MESSAGE”</p>
<p>ChatServer.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h60;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChatServer</span> &#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 初始化 ， 根据情况适当抛出异常</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> port</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> passwordFilename 所有用户的用户名 口令</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> port;</span><br><span class="line">	<span class="keyword">private</span> String passwordFilename;</span><br><span class="line">	<span class="keyword">private</span> Map&lt;String,String&gt; userDetails;</span><br><span class="line">	<span class="keyword">private</span> Set&lt;ClientHandler&gt; clientHandlers;		<span class="comment">//保存所有登录的用户</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;String&gt; messageList;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">ChatServer</span> <span class="params">(<span class="type">int</span> port, String passwordFilename)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">		<span class="built_in">this</span>.port = port;</span><br><span class="line">		<span class="built_in">this</span>.passwordFilename = passwordFilename;</span><br><span class="line">		userDetails = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">		clientHandlers = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">		messageList = Collections.synchronizedList(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">		loadUsersDetails();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">loadUsersDetails</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(passwordFilename);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(f));</span><br><span class="line">			<span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">			<span class="keyword">while</span>((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">				String[] detail = line.split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">				<span class="keyword">if</span>(detail.length == <span class="number">2</span>) &#123;</span><br><span class="line">					userDetails.put(detail[<span class="number">0</span>], detail[<span class="number">1</span>]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *  根据情况适当抛出异常</span></span><br><span class="line"><span class="comment">	 * 开始监听</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">startListen</span><span class="params">( )</span> &#123;</span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">			<span class="type">ServerSocket</span> <span class="variable">server</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				server = <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(port);</span><br><span class="line">				System.out.println(<span class="string">&quot;chat server listen on port:&quot;</span> + port + <span class="string">&quot; ok!&quot;</span>);</span><br><span class="line">				<span class="keyword">while</span>(flag) &#123;</span><br><span class="line">					<span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> server.accept();</span><br><span class="line">					<span class="type">ClientHandler</span> <span class="variable">clientHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClientHandler</span>(socket);</span><br><span class="line">					clientHandlers.add(clientHandler);</span><br><span class="line">					<span class="keyword">new</span> <span class="title class_">Thread</span>(clientHandler).start();</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;).start();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">ClientHandler</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Socket clientSocket;</span><br><span class="line">        <span class="keyword">private</span> PrintWriter out;</span><br><span class="line">        <span class="keyword">private</span> BufferedReader in;</span><br><span class="line">        <span class="keyword">private</span> String userName;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> loggedIn;			<span class="comment">//判断是否已经登录</span></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> messageIndex;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ClientHandler</span><span class="params">(Socket clientSocket)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.clientSocket = clientSocket;</span><br><span class="line">            loggedIn = <span class="literal">false</span>;</span><br><span class="line">            messageIndex = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                out = <span class="keyword">new</span> <span class="title class_">PrintWriter</span>(clientSocket.getOutputStream(), <span class="literal">true</span>);</span><br><span class="line">                in = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(clientSocket.getInputStream()));</span><br><span class="line"></span><br><span class="line">                String inputLine;</span><br><span class="line">                <span class="keyword">while</span> ((inputLine = in.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                    String[] parts = inputLine.split(<span class="string">&quot; &quot;</span>, <span class="number">2</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">command</span> <span class="operator">=</span> parts[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (command.equals(<span class="string">&quot;LOGIN&quot;</span>)) &#123;</span><br><span class="line">                        String[] credentials = parts[<span class="number">1</span>].split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                        <span class="keyword">if</span> (credentials.length == <span class="number">2</span> &amp;&amp; authenticate(credentials[<span class="number">0</span>], credentials[<span class="number">1</span>])) &#123;</span><br><span class="line">                            userName = credentials[<span class="number">0</span>];</span><br><span class="line">                            loggedIn = <span class="literal">true</span>;</span><br><span class="line">                            out.println(<span class="string">&quot;LOGIN SUCCESS&quot;</span>);</span><br><span class="line">                            broadcastMessage(<span class="string">&quot;SYSTEM &quot;</span>+ userName + <span class="string">&quot; has joined the chat&quot;</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            out.println(<span class="string">&quot;LOGIN FAILURE&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (command.equals(<span class="string">&quot;LOGOUT&quot;</span>)) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (userName != <span class="literal">null</span>) &#123;</span><br><span class="line">                            broadcastMessage(<span class="string">&quot;SYSTEM &quot;</span>+ userName + <span class="string">&quot; has left the chat&quot;</span>);</span><br><span class="line">                            clientHandlers.remove(<span class="built_in">this</span>);</span><br><span class="line">                            loggedIn = <span class="literal">false</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (command.equals(<span class="string">&quot;SPEAK&quot;</span>)) &#123;</span><br><span class="line">                    	<span class="keyword">if</span>(loggedIn) &#123;</span><br><span class="line">                    		<span class="keyword">if</span> (userName != <span class="literal">null</span>) &#123;</span><br><span class="line">                            	<span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;MESSAGE &quot;</span>+ parts[<span class="number">1</span>];		<span class="comment">//这里不用写是谁说的（根据Test要求）</span></span><br><span class="line">                                <span class="keyword">synchronized</span>(messageList) &#123;</span><br><span class="line">                                	messageList.add(message);</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="comment">//broadcastMessage(message);			//如果还广播的话，就会出现四个MESSAGE信息</span></span><br><span class="line">                            &#125;</span><br><span class="line">                    	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    		out.println(<span class="string">&quot;You need to login first!&quot;</span>);</span><br><span class="line">                    	&#125;</span><br><span class="line">                        </span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (command.equals(<span class="string">&quot;READ&quot;</span>)) &#123;</span><br><span class="line">                    	<span class="keyword">if</span>(loggedIn) &#123;</span><br><span class="line">                        	String message;</span><br><span class="line">                        	<span class="keyword">synchronized</span>(messageList) &#123;</span><br><span class="line">                        		<span class="keyword">if</span>(messageIndex &lt; messageList.size()) &#123;</span><br><span class="line">                        			out.println(messageList.get(messageIndex));</span><br><span class="line">                        			messageIndex++;</span><br><span class="line">                        		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                        			out.println(<span class="string">&quot;READ null&quot;</span>);</span><br><span class="line">                        		&#125;</span><br><span class="line">                        	&#125;</span><br><span class="line">                    	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    		out.println(<span class="string">&quot;You need to login first!&quot;</span>);</span><br><span class="line">                    	&#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (clientSocket != <span class="literal">null</span>) &#123;</span><br><span class="line">                        clientSocket.close();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">authenticate</span><span class="params">(String userName, String password)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> password.equals(userDetails.get(userName));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">broadcastMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (ClientHandler handler : clientHandlers) &#123;</span><br><span class="line">            	<span class="keyword">if</span>(handler.loggedIn) &#123;</span><br><span class="line">            		handler.out.println(message);</span><br><span class="line">            	&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ChatClient.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.huawei.classroom.student.h60;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChatClient</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> String ip;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> port;</span><br><span class="line">	<span class="keyword">private</span> Socket socket;</span><br><span class="line">	<span class="keyword">private</span> PrintWriter out;</span><br><span class="line">	<span class="keyword">private</span> BufferedReader in;</span><br><span class="line"></span><br><span class="line">	 <span class="comment">/**</span></span><br><span class="line"><span class="comment">	  * 根据情况适当抛出异常 </span></span><br><span class="line"><span class="comment">	  * <span class="doctag">@param</span> ip</span></span><br><span class="line"><span class="comment">	  * <span class="doctag">@param</span> port</span></span><br><span class="line"><span class="comment">	  */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">ChatClient</span> <span class="params">(String ip, <span class="type">int</span> port)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.ip = ip;</span><br><span class="line">		<span class="built_in">this</span>.port = port;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 登录,成功返回true，否则返回false，根据情况适当抛出异常 </span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> userName</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> password</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">login</span><span class="params">(String userName,String password)</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			socket = <span class="keyword">new</span> <span class="title class_">Socket</span>(ip, port);</span><br><span class="line">			out = <span class="keyword">new</span> <span class="title class_">PrintWriter</span>(socket.getOutputStream(), <span class="literal">true</span>);</span><br><span class="line">			in = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(socket.getInputStream()));</span><br><span class="line">			</span><br><span class="line">			out.println(<span class="string">&quot;LOGIN &quot;</span>+userName + <span class="string">&quot; &quot;</span>+password);</span><br><span class="line">			<span class="type">String</span> <span class="variable">response</span> <span class="operator">=</span> in.readLine();</span><br><span class="line">			<span class="keyword">return</span> response.equals(<span class="string">&quot;LOGIN SUCCESS&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 退出，根据情况适当抛出异常 </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logout</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(socket != <span class="literal">null</span> &amp;&amp; out != <span class="literal">null</span>) &#123;</span><br><span class="line">			out.println(<span class="string">&quot;LOGOUT&quot;</span>);</span><br><span class="line">			closeConnection();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 发言, 只有登录以后才能发言， 根据情况适当抛出异常 </span></span><br><span class="line"><span class="comment">	 * 如果没有登录 抛出异常</span></span><br><span class="line"><span class="comment">	 *  </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> str</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">speak</span><span class="params">(String str)</span> &#123;</span><br><span class="line">		 <span class="keyword">if</span>(out != <span class="literal">null</span>) &#123;</span><br><span class="line">			 out.println(<span class="string">&quot;SPEAK &quot;</span>+ str);</span><br><span class="line">		 &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 读取聊天室目前的发言，根据情况适当抛出异常 </span></span><br><span class="line"><span class="comment">	 * 只有登录以后才可以读到,否则返回null</span></span><br><span class="line"><span class="comment">	 * 得到聊天室里面所有的发言（包括自己的），如果此时没有发言则立刻返回null，否则每次调用read的时候按队的方式返回一个句话</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">read</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(out != <span class="literal">null</span>) &#123;</span><br><span class="line">			out.println(<span class="string">&quot;READ&quot;</span>);</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				String response;</span><br><span class="line">                <span class="keyword">while</span> ((response = in.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (response.startsWith(<span class="string">&quot;MESSAGE &quot;</span>)) &#123;</span><br><span class="line">                        <span class="keyword">return</span> response.substring(<span class="number">8</span>);</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (response.startsWith(<span class="string">&quot;READ null&quot;</span>)) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(response.equals(<span class="string">&quot;You need to login first!&quot;</span>)) &#123;</span><br><span class="line">                    	<span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 如果是系统消息，继续读取</span></span><br><span class="line">                &#125;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				<span class="comment">//e.printStackTrace();</span></span><br><span class="line">				<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">closeConnection</span><span class="params">()</span> &#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(socket != <span class="literal">null</span>) &#123;</span><br><span class="line">				socket.close();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(out != <span class="literal">null</span>) &#123;</span><br><span class="line">				out.close();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(in != <span class="literal">null</span>) &#123;</span><br><span class="line">				in.close();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

 
   <div>
     <div>
    
        <div style="text-align:center;color: #ccc;font-size:24px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
   </div>
 
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>charoneo
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://example.com/2024/04/19/java%E4%BD%9C%E4%B8%9A/" title="java作业">http://example.com/2024/04/19/java作业/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/java%E5%AE%9E%E9%AA%8C/" rel="tag"># java实验</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/04/16/java%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1-lab2/" rel="prev" title="java程序设计-lab2">
      <i class="fa fa-chevron-left"></i> java程序设计-lab2
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/04/20/%E5%A5%87%E6%80%AA%E7%9A%84cpp%E4%BD%9C%E4%B8%9A/" rel="next" title="奇怪的cpp作业">
      奇怪的cpp作业 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="SOHUCS"></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#h03"><span class="nav-number">1.</span> <span class="nav-text">h03</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h08"><span class="nav-number">2.</span> <span class="nav-text">h08</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h09"><span class="nav-number">3.</span> <span class="nav-text">h09</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h10"><span class="nav-number">4.</span> <span class="nav-text">h10</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h11"><span class="nav-number">5.</span> <span class="nav-text">h11</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h12"><span class="nav-number">6.</span> <span class="nav-text">h12</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h13"><span class="nav-number">7.</span> <span class="nav-text">h13</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h14"><span class="nav-number">8.</span> <span class="nav-text">h14</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h15"><span class="nav-number">9.</span> <span class="nav-text">h15</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h16"><span class="nav-number">10.</span> <span class="nav-text">h16</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h17"><span class="nav-number">11.</span> <span class="nav-text">h17</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%9E%9A%E4%B8%BE%E7%B1%BB"><span class="nav-number">11.1.</span> <span class="nav-text">1.枚举类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%8F%82%E6%95%B0%E7%B1%BB%EF%BC%88%E7%AE%80%E7%95%A5%E7%89%88%EF%BC%89"><span class="nav-number">11.2.</span> <span class="nav-text">2.参数类（简略版）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Battlefield%E7%B1%BB"><span class="nav-number">11.3.</span> <span class="nav-text">3.Battlefield类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Player%E7%B1%BB%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">11.4.</span> <span class="nav-text">4.Player类的实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-GameObject%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">11.5.</span> <span class="nav-text">5.GameObject的实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E5%85%B6%E4%BB%96%E5%90%84%E7%B1%BB"><span class="nav-number">11.6.</span> <span class="nav-text">6.其他各类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h18"><span class="nav-number">12.</span> <span class="nav-text">h18</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h19"><span class="nav-number">13.</span> <span class="nav-text">h19</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h20"><span class="nav-number">14.</span> <span class="nav-text">h20</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h31"><span class="nav-number">15.</span> <span class="nav-text">h31</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#q02"><span class="nav-number">15.1.</span> <span class="nav-text">q02</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#q06"><span class="nav-number">15.2.</span> <span class="nav-text">q06</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#q10"><span class="nav-number">15.3.</span> <span class="nav-text">q10</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#q11"><span class="nav-number">15.4.</span> <span class="nav-text">q11</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h51"><span class="nav-number">16.</span> <span class="nav-text">h51</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h52"><span class="nav-number">17.</span> <span class="nav-text">h52</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h53"><span class="nav-number">18.</span> <span class="nav-text">h53</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h54"><span class="nav-number">19.</span> <span class="nav-text">h54</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h55"><span class="nav-number">20.</span> <span class="nav-text">h55</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h56"><span class="nav-number">21.</span> <span class="nav-text">h56</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h57"><span class="nav-number">22.</span> <span class="nav-text">h57</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h58"><span class="nav-number">23.</span> <span class="nav-text">h58</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h59"><span class="nav-number">24.</span> <span class="nav-text">h59</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#h60"><span class="nav-number">25.</span> <span class="nav-text">h60</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Charoneo"
      src="/images/avatar.webp">
  <p class="site-author-name" itemprop="name">Charoneo</p>
  <div class="site-description" itemprop="description">个人博客</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">28</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/sdythmh" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;sdythmh" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:sdythmh@gmail.com" title="E-Mail → mailto:sdythmh@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.weibo.com/u/7788881505" title="Weibo → https:&#x2F;&#x2F;www.weibo.com&#x2F;u&#x2F;7788881505" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      链接网站
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://baidu.com/" title="https:&#x2F;&#x2F;baidu.com" rel="noopener" target="_blank">百度</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://pornhub.com/" title="https:&#x2F;&#x2F;pornhub.com" rel="noopener" target="_blank">学习资料1</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://xvideos.com/" title="https:&#x2F;&#x2F;xvideos.com" rel="noopener" target="_blank">学习资料2</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2024-03 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Charoneo</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">252k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">3:49</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>



    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">总访客数<span id="busuanzi_value_site_uv"></span>人</span>
    <span class="post-meta-divider">|</span>
<!-- 不蒜子计数初始值纠正 -->
<script>
$(document).ready(function() {

    var int = setInterval(fixCount, 50);  // 50ms周期检测函数
    var countOffset = 20000;  // 初始化首次数据

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // 加上初始数据 
            clearInterval(int); // 停止检测
        }  
    }
       	
});
</script> 

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  <script>
  NexT.utils.loadComments(document.querySelector('#SOHUCS'), () => {
    var appid = 'cyxdgXkVT';
    var conf = '20f2cb29a4fd310a7e302dcb02e3bbe0';
    var width = window.innerWidth || document.documentElement.clientWidth;
    if (width < 960) {
      window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>');
    } else {
      var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})});
    }
  });
  </script>
  <script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script>

</body>
</html>
